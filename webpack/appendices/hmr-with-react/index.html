<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="" />
    <meta
      name="keywords"
      content="" />
    <title>Hot Module Replacement with React</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.d6e1ce54d243dd2620ec.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <div><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/1e39daa3c8d3df1fd22b98b601fe6b3d.jpg);"></div><h1 class="post__heading">Hot Module Replacement with React</h1><div class="header-extra"><a href="https://pixabay.com/en/event-technology-light-panel-644537/">Marko Heinrich (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/foreword/">Foreword</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction/">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/what-is-webpack/">What is Webpack</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing/">Developing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/getting-started/">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/automatic-browser-refresh/">Automatic Browser Refresh</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/linting/">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/composing-configuration/">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/styling/">Styling</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/loading/">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/separating-css/">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/autoprefixing/">Autoprefixing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/eliminating-unused-css/">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/linting/">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/loading/">Loading Assets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/loader-definitions/">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/images/">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/fonts/">Loading Fonts</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/javascript/">Loading JavaScript</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building/">Building</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/source-maps/">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/bundle-splitting/">Bundle Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/code-splitting/">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/tidying-up/">Tidying Up</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing/">Optimizing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/minifying/">Minifying</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/tree-shaking/">Tree Shaking</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/environment-variables/">Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/adding-hashes-to-filenames/">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/separating-manifest/">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/analyzing-build-statistics/">Analyzing Build Statistics</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/performance/">Performance</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/output/">Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/targets/">Build Targets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/bundling-libraries/">Bundling Libraries</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/library-output/">Library Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/multiple-pages/">Multiple Pages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/server-side-rendering/">Server Side Rendering</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/techniques/">Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/dynamic-loading/">Dynamic Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/web-workers/">Web Workers</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/i18n/">Internationalization</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/testing/">Testing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/deploying/">Deploying Applications</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/packages/">Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming/">Consuming Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming-techniques/">Package Consuming Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring/">Authoring Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring-techniques/">Package Authoring Techniques</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending/">Extending</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/loaders/">Extending with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/plugins/">Extending with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/conclusion/">Conclusion</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices/">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/comparison/">Comparison of Build Tools</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr/">Hot Module Replacement</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Hot Module Replacement with React</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint/">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react/">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/troubleshooting/">Troubleshooting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/glossary/">Glossary</a></li></ul><div><div class="buy-container"><a href="/webpack/foreword"><img alt="Webpack book cover" class="sidebar-cover" src="/8f86c1d07d5536454690030cd1a10b53.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img alt="React book cover" class="sidebar-cover" src="/b61671d95f81496495f2587a10ddb122.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></blockquote></div><div class="chapter-content"><p>Hot module replacement was one of the initial selling points of webpack and React. It relies on the <a href="https://www.npmjs.com/package/react-hot-loader">react-hot-loader</a> package. At the time of writing, version 3 of <em>react-hot-loader</em> is in beta. It requires changes to three places: Babel configuration, webpack configuration, and application.</p>
<p>Before proceeding, make sure you have HMR set up as discussed in the <a href="/webpack/appendices/hmr/">Hot Module Replacement</a> appendix.</p>
<p>To get started, install the upcoming version of <em>react-hot-loader</em> as a normal dependency as it comes with a small application dependency:</p>
<pre><code class="lang-bash">npm <span class="token function" >install</span> react-hot-loader@next --save
</code></pre>
<h2 class="header"><a class="header-anchor" href="#setting-up-babel" id="setting-up-babel"></a><span class="text">Setting Up Babel</span><a class="header-anchor-select" href="#setting-up-babel">#</a></h2>
<p>To connect Babel with <em>react-hot-loader</em>, it needs to become aware of its plugin portion:</p>
<p><strong>.babelrc</strong></p>
<pre><code class="lang-json"><span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span><span class="token string" >"syntax-dynamic-import"</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
<div class="leanpub-insert">
  <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span><span class="token string" >"syntax-dynamic-import"</span><span class="token punctuation" >,</span> <span class="token string" >"react-hot-loader/babel"</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
  ...
<span class="token punctuation" >}</span>
</code></pre>
<h2 class="header"><a class="header-anchor" href="#setting-up-webpack" id="setting-up-webpack"></a><span class="text">Setting Up Webpack</span><a class="header-anchor-select" href="#setting-up-webpack">#</a></h2>
<p>On the webpack side, <em>react-hot-loader</em> requires an additional entry it uses to patch the running application. It&#39;s important the new entry runs first as otherwise the setup fails to work reliably:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript">module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> pages <span class="token operator" >=</span> <span class="token punctuation" >[</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    parts<span class="token punctuation" >.</span><span class="token function" >page</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>
      title<span class="token punctuation" >:</span> <span class="token string" >'React demo'</span><span class="token punctuation" >,</span>
      path<span class="token punctuation" >:</span> <span class="token string" >'react'</span><span class="token punctuation" >,</span>
      entry<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
<div class="leanpub-delete">
        react<span class="token punctuation" >:</span> reactDemo<span class="token punctuation" >,</span>
</div>
<div class="leanpub-insert">
        react<span class="token punctuation" >:</span> env <span class="token operator" >===</span> <span class="token string" >'production'</span> <span class="token operator" >?</span>
          PATHS<span class="token punctuation" >.</span>reactDemo <span class="token punctuation" >:</span>
          <span class="token punctuation" >[</span><span class="token string" >'react-hot-loader/patch'</span><span class="token punctuation" >,</span> PATHS<span class="token punctuation" >.</span>reactDemo<span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      chunks<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'react'</span><span class="token punctuation" >,</span> <span class="token string" >'manifest'</span><span class="token punctuation" >,</span> <span class="token string" >'vendor'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>Patching is needed still as you have to make the application side aware of hot loading.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>This tweak is not required in the future as <em>react-hot-loader</em> evolves. It&#39;s possible to inject an empty module for <code>&#39;react-hot-loader/patch&#39;</code> if it detects that production environment is used. For now, it&#39;s needed, though.</blockquote><h2 class="header"><a class="header-anchor" href="#setting-up-the-application" id="setting-up-the-application"></a><span class="text">Setting Up the Application</span><a class="header-anchor-select" href="#setting-up-the-application">#</a></h2>
<p>On React side, <em>react-hot-loader</em> relies on an <code>AppContainer</code> that deals with patching. You still have to implement the Hot Module Replacement interface as earlier. Set up an entry point for the demo as follows:</p>
<p><strong>app/react.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> ReactDOM <span class="token keyword" >from</span> <span class="token string" >'react-dom'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> Counter <span class="token keyword" >from</span> <span class="token string" >'./counter'</span><span class="token punctuation" >;</span>
<span class="token keyword" >import</span> <span class="token punctuation" >{</span> AppContainer <span class="token punctuation" >}</span> <span class="token keyword" >from</span> <span class="token string" >'react-hot-loader'</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> app <span class="token operator" >=</span> document<span class="token punctuation" >.</span><span class="token function" >createElement</span><span class="token punctuation" >(</span><span class="token string" >'div'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
document<span class="token punctuation" >.</span>body<span class="token punctuation" >.</span><span class="token function" >appendChild</span><span class="token punctuation" >(</span>app<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token keyword" >const</span> render <span class="token operator" >=</span> App <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  ReactDOM<span class="token punctuation" >.</span><span class="token function" >render</span><span class="token punctuation" >(</span>
    <span class="token operator" >&lt;</span>AppContainer<span class="token operator" >></span><span class="token operator" >&lt;</span>App <span class="token operator" >/</span><span class="token operator" >></span><span class="token operator" >&lt;</span><span class="token operator" >/</span>AppContainer<span class="token operator" >></span><span class="token punctuation" >,</span>
    app
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token function" >render</span><span class="token punctuation" >(</span>Counter<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token keyword" >if</span> <span class="token punctuation" >(</span>module<span class="token punctuation" >.</span>hot<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  module<span class="token punctuation" >.</span>hot<span class="token punctuation" >.</span><span class="token function" >accept</span><span class="token punctuation" >(</span><span class="token string" >'./counter'</span><span class="token punctuation" >,</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token function" >render</span><span class="token punctuation" >(</span>Counter<span class="token punctuation" >)</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>To test the setup, a component is needed as well. In this case, it&#39;s going to be a counter so you can see how the hot replacement mechanism maintains the state:</p>
<p><strong>app/counter.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >import</span> React <span class="token keyword" >from</span> <span class="token string" >'react'</span><span class="token punctuation" >;</span>

<span class="token keyword" >class</span> <span class="token class-name" >Counter</span> <span class="token keyword" >extends</span> <span class="token class-name" >React<span class="token punctuation" >.</span>Component</span> <span class="token punctuation" >{</span>
  <span class="token function" >constructor</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >super</span><span class="token punctuation" >(</span>props<span class="token punctuation" >)</span><span class="token punctuation" >;</span>

    <span class="token keyword" >this</span><span class="token punctuation" >.</span>state <span class="token operator" >=</span> <span class="token punctuation" >{</span> amount<span class="token punctuation" >:</span> <span class="token number" >0</span> <span class="token punctuation" >}</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
  <span class="token function" >render</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token keyword" >return</span> <span class="token punctuation" >(</span>
      <span class="token operator" >&lt;</span>div<span class="token operator" >></span>
        <span class="token operator" >&lt;</span>span className<span class="token operator" >=</span><span class="token string" >"fa fa-hand-spock-o fa-1g"</span><span class="token operator" >></span>
          Amount<span class="token punctuation" >:</span> <span class="token punctuation" >{</span><span class="token keyword" >this</span><span class="token punctuation" >.</span>state<span class="token punctuation" >.</span>amount<span class="token punctuation" >}</span>
        <span class="token operator" >&lt;</span><span class="token operator" >/</span>span<span class="token operator" >></span>
        <span class="token operator" >&lt;</span>button onClick<span class="token operator" >=</span><span class="token punctuation" >{</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token keyword" >this</span><span class="token punctuation" >.</span><span class="token function" >setState</span><span class="token punctuation" >(</span>addOne<span class="token punctuation" >)</span><span class="token punctuation" >}</span><span class="token operator" >></span>
          Add one
        <span class="token operator" >&lt;</span><span class="token operator" >/</span>button<span class="token operator" >></span>
      <span class="token operator" >&lt;</span><span class="token operator" >/</span>div<span class="token operator" >></span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >const</span> addOne <span class="token operator" >=</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span> amount <span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span> amount<span class="token punctuation" >:</span> amount <span class="token operator" >+</span> <span class="token number" >1</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> Counter<span class="token punctuation" >;</span>
</code></pre>
<p>If you run the application after these changes and modify the file above, it should pick up changes without a hard refresh while retaining the amount.</p>
<h2 class="header"><a class="header-anchor" href="#removing-react-hot-loader-related-code-from-the-production-output" id="removing-react-hot-loader-related-code-from-the-production-output"></a><span class="text">Removing <em>react-hot-loader</em> Related Code from the Production Output</span><a class="header-anchor-select" href="#removing-react-hot-loader-related-code-from-the-production-output">#</a></h2>
<p>If you build the application (<code>npm run build</code>) and examine the output, you spot references to <code>__REACT_HOT_LOADER__</code> there due to the Babel setup. It uses <code>react-hot-loader/babel</code> plugin regardless of the build target. To overcome this slight annoyance, you should configure Babel to apply the plugin only when you are developing.</p>
<p>Babel provides an <a href="https://babeljs.io/docs/usage/babelrc/#env-option">env option</a> for this purpose. It respects both <code>NODE_ENV</code> and <code>BABEL_ENV</code> environment variables. If <code>BABEL_ENV</code> is set, it receives precedence. To fix the issue, you can push the problematic Babel plugin behind a development specific <code>env</code> while controlling its behavior within webpack configuration by setting <code>BABEL_ENV</code>.</p>
<p>The webpack portion should be adjusted:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript">module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-insert">
  process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>BABEL_ENV <span class="token operator" >=</span> env<span class="token punctuation" >;</span>
</div>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>Now Babel will receive the same <code>env</code> as webpack allowing you to fix the behavior.</p>
<p>Tweak Babel setup, so it matches the fields below. The key part is in pushing <code>react-hot-loader/patch</code> below <code>env</code>:</p>
<p><strong>.babelrc</strong></p>
<pre><code class="lang-json"><span class="token punctuation" >{</span>
<div class="leanpub-delete">
  <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
    <span class="token string" >"syntax-dynamic-import"</span><span class="token punctuation" >,</span>
    <span class="token string" >"react-hot-loader/babel"</span>
  <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
<div class="leanpub-insert">
  <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span><span class="token string" >"syntax-dynamic-import"</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
</div>
  ...
<div class="leanpub-insert">
  <span class="token property" >"env"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
    <span class="token property" >"development"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
      <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
        <span class="token string" >"react-hot-loader/babel"</span>
      <span class="token punctuation" >]</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
</div>
<span class="token punctuation" >}</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>This tweak may not be required in the future as <em>react-hot-loader</em> evolves further. See the <a href="/webpack/loading/javascript/">Loading JavaScript</a> chapter to learn more about Babel <code>env</code>.</blockquote><p>The development setup should work after this change still. If you examine the build output, you should notice it&#39;s missing references to <code>__REACT_HOT_LOADER__</code>.</p>
<p>Even after this change, the source can contain references still due to a <a href="https://github.com/gaearon/react-hot-loader/issues/471">bug in react-hot-loader</a> as it has been built so that it loses information. The issue can be worked around by implementing a module chooser pattern as in the <a href="/webpack/optimizing/environment-variables/">Environment Variables</a> chapter. <code>AppContainer</code> provided by <em>react-hot-loader</em> should be mocked with a dummy.</p>
<h2 class="header"><a class="header-anchor" href="#configuring-hmr-with-redux" id="configuring-hmr-with-redux"></a><span class="text">Configuring HMR with Redux</span><a class="header-anchor-select" href="#configuring-hmr-with-redux">#</a></h2>
<p><a href="http://redux.js.org/">Redux</a> is a popular state management library designed HMR in mind. To configure Redux reducers to support HMR, you have to implement the protocol as above:</p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> configureStore <span class="token operator" >=</span> <span class="token punctuation" >(</span>initialState<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> store <span class="token operator" >=</span> <span class="token function" >createStoreWithMiddleware</span><span class="token punctuation" >(</span>
    rootReducer<span class="token punctuation" >,</span>
    initialState
  <span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  <span class="token keyword" >if</span><span class="token punctuation" >(</span>module<span class="token punctuation" >.</span>hot<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
    <span class="token comment" spellcheck="true">// Enable webpack hot module replacement for reducers</span>
    module<span class="token punctuation" >.</span>hot<span class="token punctuation" >.</span><span class="token function" >accept</span><span class="token punctuation" >(</span>
      <span class="token string" >'../reducers'</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> store<span class="token punctuation" >.</span><span class="token function" >replaceReducer</span><span class="token punctuation" >(</span>reducers<span class="token punctuation" >)</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation" >}</span>

  <span class="token keyword" >return</span> store<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >export</span> <span class="token keyword" >default</span> configureStore<span class="token punctuation" >;</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>You can find <a href="https://github.com/survivejs-demos/redux-demo">a full implementation of the idea online</a>.</blockquote><h2 class="header"><a class="header-anchor" href="#configuring-webpack-to-work-with-jsx" id="configuring-webpack-to-work-with-jsx"></a><span class="text">Configuring Webpack to Work with JSX</span><a class="header-anchor-select" href="#configuring-webpack-to-work-with-jsx">#</a></h2>
<p>Sometimes people prefer to name their React components containing JSX using the <code>.jsx</code> suffix. Webpack can be configured to work with this convention. The benefit of doing this is that then your editor is able to pick up the right syntax based on the file name alone. Another option is to configure the editor to use JSX syntax for <code>.js</code> files as it&#39;s a superset of JavaScript.</p>
<p>Webpack provides <a href="https://webpack.js.org/guides/migrating/#resolve-extensions">resolve.extensions</a> field that can be used for configuring its extension lookup. If you want to allow imports like <code>import Button from &#39;./Button&#39;;</code> while naming the file as <em>Button.jsx</em>, set it up as follows:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  resolve<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    extensions<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token string" >'.js'</span><span class="token punctuation" >,</span> <span class="token string" >'.jsx'</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>To resolve the problem at loader configuration, instead of matching against <code>/\.js$/</code>, you can expand it to include <code>.jsx</code> extension through <code>/\.(js|jsx)$/</code>. Another option would be to write <code>/\.jsx?$/</code>, but the explicit alternative is more readable.</p>
<blockquote class="warning"><i class="icon-attention"></i>In webpack 1 you had to use <code>extensions: [&#39;&#39;, &#39;.js&#39;, &#39;.jsx&#39;]</code> to match files without an extension too. This isn&#39;t needed in webpack 2.</blockquote><h2 class="header"><a class="header-anchor" href="#get-started-fast-with-create-react-app-" id="get-started-fast-with-create-react-app-"></a><span class="text">Get Started Fast with <em>create-react-app</em></span><a class="header-anchor-select" href="#get-started-fast-with-create-react-app-">#</a></h2>
<p><a href="https://www.npmjs.com/package/create-react-app">create-react-app</a> allows you to get started fast with webpack and React. It&#39;s a zero configuration approach that encapsulates a lot of best practices allowing you to get started fast with minimal setup.</p>
<p><em>create-react-app</em> allows you to extract a full-blown webpack setup by <strong>ejecting</strong>. There&#39;s a problem, though. After you eject, you cannot go back to the dependency-based model, and you have to maintain the resulting setup yourself.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p><em>react-hot-loader</em> allows you to set up HMR with webpack. It was one of the initial selling points of both and is still a good technique. The setup takes care, but after you have it running, it&#39;s nice.</p>
<p>To recap:</p>
<ul>
<li>Setting up <em>react-hot-loader</em> requires changes to Babel, webpack, and application.</li>
<li>On Babel level you must enable <em>react-hot-loader/babel</em> plugin.</li>
<li>Webpack configuration has to inject <code>&#39;react-hot-loader/patch&#39;</code> entry before the application.</li>
<li>Application has to be wrapped into <code>AppContainer</code> provided by <em>react-hot-loader</em>.</li>
<li>The setup may get easier to manage as <em>react-hot-loader</em> develops further.</li>
<li>HMR can be configured to work with Redux by implementing <code>module.hot.accept</code> against reducers.</li>
<li>Webpack makes it convenient to work with <code>.jsx</code> files.</li>
<li><em>create-react-app</em> allows you to get started fast with webpack and React.</li>
</ul>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/1c7db2542f5841213cf0f9ea6b6ccf19.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/appendices/hmr/">Hot Module Replacement</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/75bbd7c9f6eeb10dded8b663130e7462.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/appendices/customizing-eslint/">Customizing ESLint</a></div></div><blockquote class="tip"><p>This book is available through <a href="https://leanpub.com/survivejs-webpack">Leanpub (digital)</a>, <a href="https://www.amazon.com/dp/9526868803">Amazon (paperback)</a>, and <a href="https://www.amazon.com/dp/B06XWZZGBS">Kindle (digital)</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Customizing ESLint" href="/webpack/appendices/customizing-eslint/"><i class="icon-right-open"></i></a><a class="previous-page" title="Hot Module Replacement" href="/webpack/appendices/hmr/"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog/">Read the blog</a></div><div class="nav__link"><a href="/training/">Get training</a></div><div class="nav__link"><a href="https://leanpub.com/survivejs-webpack">Buy the ebook</a></div><div class="nav__link"><a href="/"></a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li><a class="blog-teaser" href="/blog/webexpo-2017/">Experiences on WebExpo 2017</a></li><li><a class="blog-teaser" href="/blog/kea-interview/">Kea - High level abstraction between React and Redux - Interview with Marius Andra</a></li><li><a class="blog-teaser" href="/blog/react-next-2017/">Experiences on React Next 2017</a></li><li><a class="blog-teaser" href="/blog/frint-interview/">FrintJS - Build reactive applications with React and RxJS - Interview with Fahad Ibnay Heylaal</a></li><li><a class="blog-teaser" href="/blog/neutrino-interview/">Neutrino - Create modern JavaScript applications with minimal configuration - Interview with Eli Perelman</a></li><li><a class="blog-teaser" href="/blog/idyll-interview/">Idyll - Narratives for the web - Interview with Matthew Conlen</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
          indexName: 'survivejs_webpack',
          inputSelector: '#search',
          debug: false
        });
      </script></div></div>

    
  </body>
</html>
