<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="" />
    <meta
      name="keywords"
      content="" />
    <title>Loading JavaScript</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.c0da21cc4a6144844d8c.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <div><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/d37cfc043394c12f965afeb50412fd57.jpg);"></div><h1 class="post__heading">Loading JavaScript</h1><div class="header-extra"><a href="https://pixabay.com/en/tower-factory-headframe-threatening-1897536/">Tama66 (Public Domain)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/foreword/">Foreword</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction/">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/what-is-webpack/">What is Webpack</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing/">Developing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/getting-started/">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/automatic-browser-refresh/">Automatic Browser Refresh</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/linting/">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/composing-configuration/">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/styling/">Styling</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/loading/">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/separating-css/">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/autoprefixing/">Autoprefixing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/eliminating-unused-css/">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/linting/">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/loading/">Loading Assets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/loader-definitions/">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/images/">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/fonts/">Loading Fonts</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Loading JavaScript</span></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building/">Building</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/source-maps/">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/bundle-splitting/">Bundle Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/code-splitting/">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/tidying-up/">Tidying Up</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing/">Optimizing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/minifying/">Minifying</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/tree-shaking/">Tree Shaking</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/environment-variables/">Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/adding-hashes-to-filenames/">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/separating-manifest/">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/analyzing-build-statistics/">Analyzing Build Statistics</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/performance/">Performance</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/output/">Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/targets/">Build Targets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/bundling-libraries/">Bundling Libraries</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/library-output/">Library Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/multiple-pages/">Multiple Pages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/server-side-rendering/">Server Side Rendering</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/techniques/">Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/dynamic-loading/">Dynamic Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/web-workers/">Web Workers</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/i18n/">Internationalization</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/testing/">Testing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/deploying/">Deploying Applications</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/packages/">Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming/">Consuming Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming-techniques/">Package Consuming Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring/">Authoring Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring-techniques/">Package Authoring Techniques</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending/">Extending</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/loaders/">Extending with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/plugins/">Extending with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/conclusion/">Conclusion</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices/">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/comparison/">Comparison of Build Tools</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr/">Hot Module Replacement</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr-with-react/">Hot Module Replacement with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint/">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react/">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/troubleshooting/">Troubleshooting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/glossary/">Glossary</a></li></ul><div><div class="buy-container"><a href="/webpack/foreword"><img alt="Webpack book cover" class="sidebar-cover" src="/8f86c1d07d5536454690030cd1a10b53.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img alt="React book cover" class="sidebar-cover" src="/b61671d95f81496495f2587a10ddb122.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/react-lite-interview/">react-lite - Implementation of React optimized for small size - Interview with Jade</a></blockquote></div><div class="chapter-content"><p>Webpack processes ES6 module definitions by default and transforms them into code. It does <strong>not</strong> transform ES6 specific syntax apart, such as <code>const</code>. The resulting code can be problematic especially in the older browsers.</p>
<p>To get a better idea of the default transform, consider the example output below:</p>
<p><strong>build/app.js</strong></p>
<pre><code class="lang-javascript"><span class="token function" >webpackJsonp</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token number" >1</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span><span class="token punctuation" >{</span>

<span class="token comment" spellcheck="true">/* 0 */</span>
<span class="token comment" spellcheck="true">/***/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>module<span class="token punctuation" >,</span> __webpack_exports__<span class="token punctuation" >,</span> __webpack_require__<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>

<span class="token string" >"use strict"</span><span class="token punctuation" >;</span>
<span class="token comment" spellcheck="true">/* harmony default export */</span> __webpack_exports__<span class="token punctuation" >[</span><span class="token string" >"a"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token keyword" >function</span> <span class="token punctuation" >(</span>text <span class="token operator" >=</span> <span class="token string" >'Hello world'</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> element <span class="token operator" >=</span> document<span class="token punctuation" >.</span><span class="token function" >createElement</span><span class="token punctuation" >(</span><span class="token string" >'div'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  element<span class="token punctuation" >.</span>className <span class="token operator" >=</span> <span class="token string" >'fa fa-hand-spock-o fa-1g'</span><span class="token punctuation" >;</span>
  element<span class="token punctuation" >.</span>innerHTML <span class="token operator" >=</span> text<span class="token punctuation" >;</span>

  <span class="token keyword" >return</span> element<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>The problem can be worked around by processing the code through <a href="https://babeljs.io/">Babel</a>, a popular JavaScript compiler that supports ES6 features and more. It resembles ESLint in that it&#39;s built on top of presets and plugins. Presets are collections of plugins, and you can define your own as well.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Given sometimes extending existing presets is not be enough, <a href="https://www.npmjs.com/package/modify-babel-preset">modify-babel-preset</a> allows you to go a step further and configure the base preset in a more flexible way.</blockquote><h2 class="header"><a class="header-anchor" href="#using-babel-with-webpack-configuration" id="using-babel-with-webpack-configuration"></a><span class="text">Using Babel with Webpack Configuration</span><a class="header-anchor-select" href="#using-babel-with-webpack-configuration">#</a></h2>
<p>Even though Babel can be used standalone, as you can see in the <a href="/webpack/packages/authoring-techniques/">Package Authoring Techniques</a> chapter, you can hook it up with webpack as well. During development, it can make sense to skip processing if you are using language features supported by your browser.</p>
<p>Skipping processing is a good option especially if you don&#39;t rely on any custom language features and work using a modern browser. Processing through Babel becomes almost a necessity when you compile your code for production, though.</p>
<p>You can use Babel with webpack through <a href="https://www.npmjs.com/package/babel-loader">babel-loader</a>. It can pick up project level Babel configuration or you can configure it at the webpack loader itself. <a href="https://www.npmjs.com/package/babel-webpack-plugin">babel-webpack-plugin</a> is another lesser known option.</p>
<p>Connecting Babel with a project allows you to process webpack configuration through it. To achieve this, name your webpack configuration using the <em>webpack.config.babel.js</em> convention. <a href="https://www.npmjs.com/package/interpret">interpret</a> package enables this and it supports other compilers as well.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Given that <a href="http://node.green/">Node supports the ES6 specification well</a> these days, you can use a lot of ES6 features without having to process configuration through Babel.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>Babel isn&#39;t the only option although it&#39;s the most popular one. <a href="https://buble.surge.sh">Buble</a> by Rich Harris is another compiler worth checking out. There&#39;s experimental <a href="https://www.npmjs.com/package/buble-loader">buble-loader</a> that allows you to use it with webpack. Buble doesn&#39;t support ES6 modules, but that&#39;s not a problem as webpack provides that functionality.</blockquote><blockquote class="warning"><i class="icon-attention"></i>If you use <em>webpack.config.babel.js</em>, take care with the <code>&quot;modules&quot;: false,</code> setting. If you want to use ES6 modules, you could skip the setting in your global Babel configuration and then configure it per environment as discussed below.</blockquote><h3 class="header"><a class="header-anchor" href="#setting-up-babel-loader-" id="setting-up-babel-loader-"></a><span class="text">Setting Up <em>babel-loader</em></span><a class="header-anchor-select" href="#setting-up-babel-loader-">#</a></h3>
<p>The first step towards configuring Babel to work with webpack is to set up <a href="https://www.npmjs.com/package/babel-loader">babel-loader</a>. It takes the code and turns it into a format older browsers can understand. Install <em>babel-loader</em> and include its peer dependency <em>babel-core</em>:</p>
<pre><code class="lang-bash">npm <span class="token function" >install</span> babel-loader babel-core --save-dev
</code></pre>
<p>As usual, let&#39;s define a part for Babel:</p>
<p><strong>webpack.parts.js</strong></p>
<pre><code class="lang-javascript">exports<span class="token punctuation" >.</span>loadJavaScript <span class="token operator" >=</span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span> include<span class="token punctuation" >,</span> exclude <span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >(</span><span class="token punctuation" >{</span>
  module<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    rules<span class="token punctuation" >:</span> <span class="token punctuation" >[</span>
      <span class="token punctuation" >{</span>
        test<span class="token punctuation" >:</span> <span class="token regex" >/\.js$/</span><span class="token punctuation" >,</span>
        include<span class="token punctuation" >,</span>
        exclude<span class="token punctuation" >,</span>

        loader<span class="token punctuation" >:</span> <span class="token string" >'babel-loader'</span><span class="token punctuation" >,</span>
        options<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
          <span class="token comment" spellcheck="true">// Enable caching for improved performance during</span>
          <span class="token comment" spellcheck="true">// development.</span>
          <span class="token comment" spellcheck="true">// It uses default OS directory by default. If you need</span>
          <span class="token comment" spellcheck="true">// something more custom, pass a path to it.</span>
          <span class="token comment" spellcheck="true">// I.e., { cacheDirectory: '&lt;path>' }</span>
          cacheDirectory<span class="token punctuation" >:</span> <span class="token boolean" >true</span><span class="token punctuation" >,</span>
        <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >]</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>Next, you need to connect this with the main configuration. If you are using a modern browser for development, you can consider processing only the production code through Babel. To play it safe, it&#39;s used for both production and development environments in this case. In addition, only application code is processed through Babel.</p>
<p>Adjust as below:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> commonConfig <span class="token operator" >=</span> <span class="token function" >merge</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<div class="leanpub-insert">
  parts<span class="token punctuation" >.</span><span class="token function" >loadJavaScript</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span> include<span class="token punctuation" >:</span> PATHS<span class="token punctuation" >.</span>app <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >,</span>
</div>
<span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>Even though you have Babel installed and set up, you are still missing one bit: Babel configuration. This can be achieved using a <em>.babelrc</em> dotfile as other tooling can pick it up as well.</p>
<blockquote class="warning"><i class="icon-attention"></i>There are times when caching Babel compilation can surprise you if your dependencies change in a way that <em>babel-loader</em> default caching mechanism doesn&#39;t notice. Override <code>cacheIdentifier</code> with a string that has been derived based on data that should invalidate the cache for better control. <a href="https://nodejs.org/api/crypto.html">Node crypto API</a> and especially its MD5 related functions can come in handy.</blockquote><blockquote class="warning"><i class="icon-attention"></i>If you try to import files <strong>outside</strong> of your configuration root directory and then process them through <em>babel-loader</em>, this fails. It&#39;s <a href="https://github.com/babel/babel-loader/issues/313">a known issue</a>, and there are workarounds including maintaining <em>.babelrc</em> at a higher level in the project and resolving against Babel presets through <code>require.resolve</code> at webpack configuration.</blockquote><h3 class="header"><a class="header-anchor" href="#setting-up-babelrc-" id="setting-up-babelrc-"></a><span class="text">Setting Up <em>.babelrc</em></span><a class="header-anchor-select" href="#setting-up-babelrc-">#</a></h3>
<p>At a minimum, you need <a href="https://www.npmjs.com/package/babel-preset-env">babel-preset-env</a>. It&#39;s a Babel preset that enables the needed plugins based on the environment definition you pass to it. It follows the <strong>browserslist</strong> definition discussed in the <a href="/webpack/styling/autoprefixing/">Autoprefixing</a> chapter.</p>
<p>Install the preset first:</p>
<pre><code class="lang-bash">npm <span class="token function" >install</span> babel-preset-env --save-dev
</code></pre>
<p>To make Babel aware of the preset, you need to write a <em>.babelrc</em>. Given webpack supports ES6 modules out of the box, you can tell Babel to skip processing them. Skipping this step would break webpack&#39;s HMR mechanism although the production build would still work. You can also constrain the build output to work only in recent versions of Chrome.</p>
<p>Adjust the target definition as you like. As long as you follow <a href="https://www.npmjs.com/package/browserslist">browserslist</a>, it should work. Here&#39;s a sample configuration:</p>
<p><strong>.babelrc</strong></p>
<pre><code class="lang-json"><span class="token punctuation" >{</span>
  <span class="token property" >"presets"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
    <span class="token punctuation" >[</span>
      <span class="token string" >"env"</span><span class="token punctuation" >,</span>
      <span class="token punctuation" >{</span>
        <span class="token property" >"modules"</span><span class="token operator" >:</span> <span class="token boolean" >false</span><span class="token punctuation" >,</span>
        <span class="token property" >"targets"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
          <span class="token property" >"browsers"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span><span class="token string" >"last 2 Chrome versions"</span><span class="token punctuation" >]</span>
        <span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span>
    <span class="token punctuation" >]</span>
  <span class="token punctuation" >]</span>
<span class="token punctuation" >}</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>If you omit the <code>targets</code> definition, <em>babel-preset-env</em> compiles to ES5 compatible code. If you are using UglifyJS, see the <a href="/webpack/optimizing/minifying/">Minifying</a> chapter for more information on why this is required. You can also target Node through the <code>node</code> field. Example: <code>&quot;node&quot;: &quot;current&quot;</code>.</blockquote><blockquote class="warning"><i class="icon-attention"></i><strong>babel-preset-env</strong> does <strong>not</strong> support <em>.browserslistrc</em> file yet. <a href="https://github.com/babel/babel-preset-env/issues/26">See issue #26</a> for more information.</blockquote><p>If you execute <code>npm run build</code> now and examine <em>build/app.js</em>, the result should be similar to the earlier since it supports the features you are using in the code.</p>
<p>To see that the target definition works, change it to work such as <code>&quot;browsers&quot;: [&quot;IE 8&quot;]</code>. Since IE 8 doesn&#39;t support <code>const</code>s, the code should change. If you build (<code>npm run build</code>), now, you should see something different:</p>
<p><strong>build/app.js</strong></p>
<pre><code class="lang-javascript"><span class="token function" >webpackJsonp</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token number" >1</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span><span class="token punctuation" >{</span>

<span class="token comment" spellcheck="true">/* 0 */</span>
<span class="token comment" spellcheck="true">/***/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>module<span class="token punctuation" >,</span> __webpack_exports__<span class="token punctuation" >,</span> __webpack_require__<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>

<span class="token string" >"use strict"</span><span class="token punctuation" >;</span>
<span class="token comment" spellcheck="true">/* harmony default export */</span> __webpack_exports__<span class="token punctuation" >[</span><span class="token string" >"a"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token keyword" >function</span> <span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >var</span> text <span class="token operator" >=</span> arguments<span class="token punctuation" >.</span>length <span class="token operator" >></span> <span class="token number" >0</span> <span class="token operator" >&amp;&amp;</span> arguments<span class="token punctuation" >[</span><span class="token number" >0</span><span class="token punctuation" >]</span> <span class="token operator" >!==</span> undefined <span class="token operator" >?</span> arguments<span class="token punctuation" >[</span><span class="token number" >0</span><span class="token punctuation" >]</span> <span class="token punctuation" >:</span> <span class="token string" >'Hello world'</span><span class="token punctuation" >;</span>

  <span class="token keyword" >var</span> element <span class="token operator" >=</span> document<span class="token punctuation" >.</span><span class="token function" >createElement</span><span class="token punctuation" >(</span><span class="token string" >'div'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>

  element<span class="token punctuation" >.</span>className <span class="token operator" >=</span> <span class="token string" >'fa fa-hand-spock-o fa-1g'</span><span class="token punctuation" >;</span>
  element<span class="token punctuation" >.</span>innerHTML <span class="token operator" >=</span> text<span class="token punctuation" >;</span>

  <span class="token keyword" >return</span> element<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>

<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Note especially how the function was transformed. You can try out different browser definitions and language features to see how the output changes based on the selection.</p>
<h2 class="header"><a class="header-anchor" href="#polyfilling-features" id="polyfilling-features"></a><span class="text">Polyfilling Features</span><a class="header-anchor-select" href="#polyfilling-features">#</a></h2>
<p><em>babel-preset-env</em> allows you to polyfill certain language features for older browsers. For this to work, you should enable its <code>useBuiltIns</code> option (<code>&quot;useBuiltIns&quot;: true</code>) and install <a href="https://babeljs.io/docs/usage/polyfill/">babel-polyfill</a>. You have include it to your project either through an import or an entry (<code>app: [&#39;babel-polyfill&#39;, PATHS.app]</code>). <em>babel-preset-env</em> rewrites the import based on your browser definition and loads only the polyfills that are needed.</p>
<p><em>babel-polyfill</em> pollutes the global scope with objects like <code>Promise</code>. Given this can be problematic for library authors, there&#39;s <a href="https://babeljs.io/docs/plugins/transform-runtime/">transform-runtime</a> option. It can be enabled as a Babel plugin, and it avoids the problem of globals by rewriting the code in such way that they aren&#39;t be needed.</p>
<blockquote class="warning"><i class="icon-attention"></i>Certain webpack features, such as <a href="/webpack/building/code-splitting/">Code Splitting</a>, write <code>Promise</code> based code to webpack&#39;s bootstrap after webpack has processed loaders. The problem can be solved by applying a shim before your application code is executed. Example: <code>entry: { app: [&#39;core-js/es6/promise&#39;, PATHS.app] }</code>.</blockquote><h2 class="header"><a class="header-anchor" href="#babel-tips" id="babel-tips"></a><span class="text">Babel Tips</span><a class="header-anchor-select" href="#babel-tips">#</a></h2>
<p>There are other possible <a href="https://babeljs.io/docs/usage/options/"><em>.babelrc</em> options</a> beyond the ones covered here. Like ESLint, <em>.babelrc</em> supports <a href="https://www.npmjs.com/package/json5">JSON5</a> as its configuration format meaning you can include comments in your source, use single quoted strings, and so on.</p>
<p>Sometimes you want to use experimental features that fit your project. Although you can find a lot of them within so-called stage presets, it&#39;s a good idea to enable them one by one and even organize them to a preset of their own unless you are working on a throwaway project. If you expect your project to live a long time, it&#39;s better to document the features you are using well.</p>
<h2 class="header"><a class="header-anchor" href="#babel-presets-and-plugins" id="babel-presets-and-plugins"></a><span class="text">Babel Presets and Plugins</span><a class="header-anchor-select" href="#babel-presets-and-plugins">#</a></h2>
<p>Perhaps the greatest thing about Babel is that it&#39;s possible to extend with presets and plugins:</p>
<ul>
<li><a href="https://www.npmjs.org/package/babel-preset-es2015">babel-preset-es2015</a> includes ES2015 features.</li>
<li><a href="https://www.npmjs.org/package/babel-preset-es2016">babel-preset-es2016</a> includes <strong>only</strong> ES2016 features. Remember to include the previous preset as well if you want both!</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-import">babel-plugin-import</a> rewrites module imports so that you can use a form such as <code>import { Button } from &#39;antd&#39;;</code> instead of pointing to the module through an exact path.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-import-asserts">babel-plugin-import-asserts</a> asserts that your imports have been defined.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-log-deprecated">babel-plugin-log-deprecated</a> adds <code>console.warn</code> to functions that have <code>@deprecate</code> annotation in their comment.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-annotate-console-log">babel-plugin-annotate-console-log</a> annotates <code>console.log</code> calls with information about invocation context so it&#39;s easier to see where they logged.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-webpack-loaders">babel-plugin-webpack-loaders</a> allows you to use certain webpack loaders through Babel.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-syntax-trailing-function-commas">babel-plugin-syntax-trailing-function-commas</a> adds trailing comma support for functions.</li>
<li><a href="https://github.com/thejameskyle/babel-react-optimize">babel-react-optimize</a> implements a variety of React specific optimizations you can experiment with.</li>
<li><a href="https://www.npmjs.com/package/babel-plugin-transform-react-remove-prop-types">babel-plugin-transform-react-remove-prop-types</a> allows you to remove <code>propType</code> related code from your production build. It also allows component authors to generate code that&#39;s wrapped so that setting environment at <code>DefinePlugin</code> can kick in as discussed in the book.</li>
</ul>
<blockquote class="tip"><i class="icon-attention-circled"></i>It&#39;s possible to connect Babel with Node through <a href="https://www.npmjs.com/package/babel-register">babel-register</a> or <a href="https://www.npmjs.com/package/babel-cli">babel-cli</a>. These packages can be handy if you want to execute your code through Babel without using webpack.</blockquote><h2 class="header"><a class="header-anchor" href="#enabling-presets-and-plugins-per-environment" id="enabling-presets-and-plugins-per-environment"></a><span class="text">Enabling Presets and Plugins per Environment</span><a class="header-anchor-select" href="#enabling-presets-and-plugins-per-environment">#</a></h2>
<p>Babel allows you to control which presets and plugins are used per environment through its <a href="https://babeljs.io/docs/usage/babelrc/#env-option">env option</a>. You can manage Babel&#39;s behavior per build target this way.</p>
<p><code>env</code> checks both <code>NODE_ENV</code> and <code>BABEL_ENV</code> and functionality to your build based on that. If <code>BABEL_ENV</code> is set, it overrides any possible <code>NODE_ENV</code>. Consider the example below:</p>
<p><strong>.babelrc</strong></p>
<pre><code class="lang-json"><span class="token punctuation" >{</span>
  ...
  <span class="token property" >"env"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
    <span class="token property" >"development"</span><span class="token operator" >:</span> <span class="token punctuation" >{</span>
      <span class="token property" >"plugins"</span><span class="token operator" >:</span> <span class="token punctuation" >[</span>
        <span class="token string" >"react-hot-loader/babel"</span>
      <span class="token punctuation" >]</span>
    <span class="token punctuation" >}</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p>Any shared presets and plugins are available to all targets still. <code>env</code> allows you to specialize your Babel configuration further.</p>
<p>It&#39;s possible to pass the webpack environment to Babel with a tweak:</p>
<p><strong>webpack.config.js</strong></p>
<pre><code class="lang-javascript">module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token punctuation" >(</span>env<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
<div class="leanpub-insert">
  process<span class="token punctuation" >.</span>env<span class="token punctuation" >.</span>BABEL_ENV <span class="token operator" >=</span> env<span class="token punctuation" >;</span>
</div>

  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<blockquote class="tip"><i class="icon-attention-circled"></i>The way <code>env</code> works is subtle. Consider logging <code>env</code> and make sure it matches your Babel configuration or otherwise the functionality you expect is not applied to your build.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>The technique is used in the <a href="/webpack/output/server-side-rendering/">Server Side Rendering</a> chapter to enable the Babel portion of <em>react-hot-loader</em> for development target only.</blockquote><h2 class="header"><a class="header-anchor" href="#setting-up-typescript" id="setting-up-typescript"></a><span class="text">Setting Up TypeScript</span><a class="header-anchor-select" href="#setting-up-typescript">#</a></h2>
<p>Microsoft&#39;s <a href="http://www.typescriptlang.org/">TypeScript</a> is a compiled language that follows a similar setup as Babel. The neat thing is that in addition to JavaScript, it can emit type definitions. A good editor can pick those up and provide enhanced editing experience. Stronger typing is valuable for development as it becomes easier to state your type contracts.</p>
<p>Compared to Facebook&#39;s type checker Flow, TypeScript is a more established option. As a result, you find more premade type definitions for it, and overall, the quality of support should be better.</p>
<p>You can use TypeScript with webpack using the following loaders:</p>
<ul>
<li><a href="https://www.npmjs.com/package/ts-loader">ts-loader</a></li>
<li><a href="https://www.npmjs.com/package/awesome-typescript-loader">awesome-typescript-loader</a></li>
<li><a href="https://www.npmjs.com/package/light-ts-loader">light-ts-loader</a></li>
</ul>
<blockquote class="tip"><i class="icon-attention-circled"></i>There&#39;s a <a href="https://www.npmjs.com/package/typescript-eslint-parser">TypeScript parser for ESLint</a>. It&#39;s also possible to lint it through <a href="https://www.npmjs.com/package/tslint">tslint</a>.</blockquote><h2 class="header"><a class="header-anchor" href="#setting-up-flow" id="setting-up-flow"></a><span class="text">Setting Up Flow</span><a class="header-anchor-select" href="#setting-up-flow">#</a></h2>
<p><a href="https://flow.org/">Flow</a> performs static analysis based on your code and its type annotations. You have to install it as a separate tool and then run it against your code. There&#39;s <a href="https://www.npmjs.com/package/flow-status-webpack-plugin">flow-status-webpack-plugin</a> that allows you to run it through webpack during development.</p>
<p>If you use React, the React specific Babel preset does most of the work through <a href="https://www.npmjs.com/package/babel-plugin-syntax-flow">babel-plugin-syntax-flow</a>. It can strip Flow annotations and convert your code into a format that is possible to transpile further.</p>
<p>There&#39;s also <a href="https://www.npmjs.com/package/babel-plugin-typecheck">babel-plugin-typecheck</a> that allows you to perform runtime checks based on your Flow annotations. <a href="https://codemix.github.io/flow-runtime/">flow-runtime</a> goes a notch further and provides more functionality. These approaches complement Flow static checker and allow you to catch even more issues.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i><a href="https://www.npmjs.com/package/flow-coverage-report">flow-coverage-report</a> shows how much of your code is covered by Flow type annotations.</blockquote><h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Babel has become an indispensable tool for developers given it bridges the standard with older browsers. Even if you targeted modern browsers, transforming through Babel is an option.</p>
<p>To recap:</p>
<ul>
<li>Babel gives you control over what browsers to support. It can compile ES6 features to a form the older browser understand. <em>babel-preset-env</em> is valuable as it can choose which features to compile and which polyfills to enable based on your browser definition.</li>
<li>Babel allows you to use experimental language features. You can find numerous plugins that improve development experience and the production build through optimizations.</li>
<li>Babel functionality can be enabled per development target. This way you can be sure you are using the correct plugins at the right place.</li>
<li>Besides Babel, webpack supports other solutions like TypeScript of Flow. Flow can complement Babel while TypeScript represents an entire language compiling to JavaScript.</li>
</ul>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/074d8abbdb6ed554a1f21462bb0c621b.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/loading/fonts/">Loading Fonts</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/182f70dd0225f637ed6b56c8fb25a2de.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/building/">Building</a></div></div><blockquote class="tip"><p>This book is available through <a href="https://leanpub.com/survivejs-webpack">Leanpub (digital)</a>, <a href="https://www.amazon.com/dp/9526868803">Amazon (paperback)</a>, and <a href="https://www.amazon.com/dp/B06XWZZGBS">Kindle (digital)</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Building" href="/webpack/building/"><i class="icon-right-open"></i></a><a class="previous-page" title="Loading Fonts" href="/webpack/loading/fonts/"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog/">Read the blog</a></div><div class="nav__link"><a href="/maintenance/">Maintenance book</a></div><div class="nav__link"><a href="/react/">React book</a></div><div class="nav__link"><a href="/webpack/">Webpack book</a></div><div class="nav__link"><a href="/training/">Get training</a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/react-lite-interview/">react-lite - Implementation of React optimized for small size - Interview with Jade</a></li><li><a class="blog-teaser" href="/blog/react-day-berlin-interview/">React Day Berlin - Fully Packed Day of Your Favorite React Content - Interview with Robert Haritonov</a></li><li><a class="blog-teaser" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li><a class="blog-teaser" href="/blog/webexpo-2017/">Experiences on WebExpo 2017</a></li><li><a class="blog-teaser" href="/blog/kea-interview/">Kea - High level abstraction between React and Redux - Interview with Marius Andra</a></li><li><a class="blog-teaser" href="/blog/react-next-2017/">Experiences on React Next 2017</a></li><li><a class="blog-teaser" href="/blog/frint-interview/">FrintJS - Build reactive applications with React and RxJS - Interview with Fahad Ibnay Heylaal</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
          indexName: 'survivejs_webpack',
          inputSelector: '#search',
          debug: false
        });
      </script></div></div>

    
  </body>
</html>
