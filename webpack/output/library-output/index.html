<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="" />
    <meta
      name="keywords"
      content="" />
    <title>Library Output</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.9bf0855ae0d4e06e5605.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <div><div class="chapter__wrapper"><div class="header-image" style="background-image:url(/26ed4b217447d9cf989ff4053ec17712.jpg);"></div><h1 class="post__heading">Library Output</h1><div class="header-extra"><a href="https://www.flickr.com/photos/19219926@N04/3707001321">Duke University Archives (CC BY-NC-SA)</a></div><div class="toc-nav__wrapper"><h4 class="search-nav--header">Search</h4><input id="search"/><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/foreword/">Foreword</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/introduction/">Introduction</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/webpack/what-is-webpack/">What is Webpack</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/developing/">Developing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/getting-started/">Getting Started</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/automatic-browser-refresh/">Automatic Browser Refresh</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/linting/">Linting JavaScript</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/developing/composing-configuration/">Composing Configuration</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/styling/">Styling</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/loading/">Loading Styles</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/separating-css/">Separating CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/autoprefixing/">Autoprefixing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/eliminating-unused-css/">Eliminating Unused CSS</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/styling/linting/">Linting CSS</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/loading/">Loading Assets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/loader-definitions/">Loader Definitions</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/images/">Loading Images</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/fonts/">Loading Fonts</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/loading/javascript/">Loading JavaScript</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/building/">Building</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/source-maps/">Source Maps</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/bundle-splitting/">Bundle Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/code-splitting/">Code Splitting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/building/tidying-up/">Tidying Up</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/optimizing/">Optimizing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/minifying/">Minifying</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/tree-shaking/">Tree Shaking</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/environment-variables/">Environment Variables</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/adding-hashes-to-filenames/">Adding Hashes to Filenames</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/separating-manifest/">Separating a Manifest</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/analyzing-build-statistics/">Analyzing Build Statistics</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/optimizing/performance/">Performance</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/output/">Output</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/targets/">Build Targets</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/bundling-libraries/">Bundling Libraries</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Library Output</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/multiple-pages/">Multiple Pages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/output/server-side-rendering/">Server Side Rendering</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/techniques/">Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/dynamic-loading/">Dynamic Loading</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/web-workers/">Web Workers</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/i18n/">Internationalization</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/testing/">Testing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/techniques/deploying/">Deploying Applications</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/packages/">Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming/">Consuming Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/consuming-techniques/">Package Consuming Techniques</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring/">Authoring Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/packages/authoring-techniques/">Package Authoring Techniques</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/extending/">Extending</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/loaders/">Extending with Loaders</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/extending/plugins/">Extending with Plugins</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/conclusion/">Conclusion</a></li><li class="toc-part"><a class="toc-nav__link part" href="/webpack/appendices/">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/comparison/">Comparison of Build Tools</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr/">Hot Module Replacement</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/hmr-with-react/">Hot Module Replacement with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/customizing-eslint/">Customizing ESLint</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/searching-with-react/">Searching with React</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/troubleshooting/">Troubleshooting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/webpack/appendices/glossary/">Glossary</a></li></ul><div><div class="buy-container"><a href="/webpack/foreword"><img alt="Webpack book cover" class="sidebar-cover" src="/8f86c1d07d5536454690030cd1a10b53.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal btn--buy" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></p></div><h3>See also</h3><div class="buy-container"><a href="/react/introduction"><img alt="React book cover" class="sidebar-cover" src="/b61671d95f81496495f2587a10ddb122.png" width="255" height="329"/></a><p><a class="btn btn--normal btn--buy" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></p></div></div></div><div class="chapter"><div class="post__content"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></blockquote></div><div class="chapter-content"><p>The example of the previous chapter can be expanded further to study webpack&#39;s library output options in detail.</p>
<p>The library target is controlled through the <code>output.libraryTarget</code> field. <code>output.library</code> comes into play as well and individual targets have additional fields related to them.</p>
<h2 class="header"><a class="header-anchor" href="#var" id="var"></a><span class="text"><code>var</code></span><a class="header-anchor-select" href="#var">#</a></h2>
<p>The demonstration project of ours uses <code>var</code> by default through configuration:</p>
<p><strong>webpack.lib.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >const</span> commonConfig <span class="token operator" >=</span> <span class="token function" >merge</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span>
  <span class="token punctuation" >{</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
    output<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
      path<span class="token punctuation" >:</span> PATHS<span class="token punctuation" >.</span>build<span class="token punctuation" >,</span>
      library<span class="token punctuation" >:</span> <span class="token string" >'Demo'</span><span class="token punctuation" >,</span>
      libraryTarget<span class="token punctuation" >:</span> <span class="token string" >'var'</span><span class="token punctuation" >,</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>The output configuration maps <code>library</code> and <code>libraryTarget</code> to the following form:</p>
<pre><code class="lang-javascript"><span class="token keyword" >var</span> Demo <span class="token operator" >=</span>
<span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>modules<span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token comment" spellcheck="true">// webpackBootstrap</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token punctuation" >[</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
<span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token comment" spellcheck="true">//# sourceMappingURL=lib.js.map</span>
</code></pre>
<p>This tells it generates <code>var &lt;output.library&gt; = &lt;webpack bootstrap&gt;</code> kind of code and also explains why importing the code from Node does not give access to any functionality.</p>
<h2 class="header"><a class="header-anchor" href="#window-global-assign-this" id="window-global-assign-this"></a><span class="text"><code>window</code>, <code>global</code>, <code>assign</code>, <code>this</code></span><a class="header-anchor-select" href="#window-global-assign-this">#</a></h2>
<p>Most of the available options vary the first line of the output as listed below:</p>
<ul>
<li><code>window</code> - <code>window[&quot;Demo&quot;] =</code></li>
<li><code>global</code> - <code>global[&quot;Demo&quot;] =</code></li>
<li><code>assign</code> - <code>Demo =</code> - If you executed this code in the right context, it would associate it to a global <code>Demo</code>.</li>
<li><code>this</code> - <code>this[&quot;Demo&quot;] =</code> - Now the code would associate to context <code>this</code> and work through Node.</li>
</ul>
<blockquote class="tip"><i class="icon-attention-circled"></i>You can try running the resulting code through Node REPL (use <code>node</code> at project root and use <code>require(&#39;./dist/lib&#39;)</code>).</blockquote><h2 class="header"><a class="header-anchor" href="#commonjs" id="commonjs"></a><span class="text">CommonJS</span><a class="header-anchor-select" href="#commonjs">#</a></h2>
<p>The CommonJS specific targets are handy when it comes to Node. There are two options: <code>commonjs</code> and <code>commonjs2</code>. These refer to different interpretations of the <a href="http://wiki.commonjs.org/wiki/CommonJS">CommonJS specification</a>. Let&#39;s explore the difference.</p>
<h3 class="header"><a class="header-anchor" href="#commonjs" id="commonjs"></a><span class="text"><code>commonjs</code></span><a class="header-anchor-select" href="#commonjs">#</a></h3>
<p>If you used the <code>commonjs</code> option, you would end up with code that expects global <code>exports</code> in which to associate:</p>
<pre><code class="lang-javascript">exports<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>If this code was imported from Node, you would get <code>{ Demo: { add: [Getter] } }</code>.</p>
<h3 class="header"><a class="header-anchor" href="#commonjs2" id="commonjs2"></a><span class="text"><code>commonjs2</code></span><a class="header-anchor-select" href="#commonjs2">#</a></h3>
<p><code>commonjs2</code> expects a global <code>module.exports</code> instead:</p>
<pre><code class="lang-javascript">module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>The library name, <code>Demo</code>, isn&#39;t used anywhere. As a result importing the module yields <code>{ add: [Getter] }</code>. You lose the extra wrapping.</p>
<h2 class="header"><a class="header-anchor" href="#amd" id="amd"></a><span class="text">AMD</span><a class="header-anchor-select" href="#amd">#</a></h2>
<p>If you remember <a href="http://requirejs.org/">RequireJS</a>, you recognize the AMD format it uses. In case you can use the <code>amd</code> target, you get output:</p>
<pre><code class="lang-javascript"><span class="token function" >define</span><span class="token punctuation" >(</span><span class="token string" >"Demo"</span><span class="token punctuation" >,</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token keyword" >return</span> <span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>modules<span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token comment" spellcheck="true">// webpackBootstrap</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>In other words, webpack has generated a named AMD module. The result doesn&#39;t work from Node as there is no support for the AMD format.</p>
<h2 class="header"><a class="header-anchor" href="#umd" id="umd"></a><span class="text">UMD</span><a class="header-anchor-select" href="#umd">#</a></h2>
<p><a href="https://github.com/umdjs/umd">Universal Module Definition</a> (UMD) was developed to solve the problem of consuming the same code from different environments. Webpack implements two output variants: <code>umd</code> and <code>umd2</code>. To understand the idea better, let&#39;s see what happens when the options are used.</p>
<h3 class="header"><a class="header-anchor" href="#umd" id="umd"></a><span class="text"><code>umd</code></span><a class="header-anchor-select" href="#umd">#</a></h3>
<p>Basic UMD output looks complicated:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >(</span><span class="token keyword" >function</span> <span class="token function" >webpackUniversalModuleDefinition</span><span class="token punctuation" >(</span>root<span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span> <span class="token operator" >&amp;&amp;</span> <span class="token keyword" >typeof</span> module <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> define <span class="token operator" >===</span> <span class="token string" >'function'</span> <span class="token operator" >&amp;&amp;</span> define<span class="token punctuation" >.</span>amd<span class="token punctuation" >)</span>
    <span class="token function" >define</span><span class="token punctuation" >(</span><span class="token string" >"Demo"</span><span class="token punctuation" >,</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    exports<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span>
    root<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span><span class="token keyword" >this</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
</code></pre>
<p>The code performs checks based on the environment and figures out what kind of export to use. The first case covers Node, the second is for AMD, the third one for Node again, while the last one includes a global environment.</p>
<p>The output can be modified further by setting <code>output.umdNamedDefine: false</code>:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >(</span><span class="token keyword" >function</span> <span class="token function" >webpackUniversalModuleDefinition</span><span class="token punctuation" >(</span>root<span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span> <span class="token operator" >&amp;&amp;</span> <span class="token keyword" >typeof</span> module <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> define <span class="token operator" >===</span> <span class="token string" >'function'</span> <span class="token operator" >&amp;&amp;</span> define<span class="token punctuation" >.</span>amd<span class="token punctuation" >)</span>
    <span class="token function" >define</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    exports<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span>
    root<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span><span class="token keyword" >this</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>To understand <code>umd2</code> option, you have to understand <em>optional externals</em> first.</p>
<h3 class="header"><a class="header-anchor" href="#optional-externals" id="optional-externals"></a><span class="text">Optional Externals</span><a class="header-anchor-select" href="#optional-externals">#</a></h3>
<p>In webpack terms, externals are dependencies that are resolved outside of webpack and are available through the environment. Optional externals are dependencies that can exist in the environment, but if they don&#39;t, they get skipped instead of failing hard.</p>
<p>Consider the following example where jQuery is loaded if it exists:</p>
<p><strong>lib/index.js</strong></p>
<pre><code class="lang-javascript"><span class="token keyword" >var</span> optionaljQuery<span class="token punctuation" >;</span>
<span class="token keyword" >try</span> <span class="token punctuation" >{</span>
  optionaljQuery <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >'jquery'</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span> <span class="token keyword" >catch</span><span class="token punctuation" >(</span>err<span class="token punctuation" >)</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span> <span class="token comment" spellcheck="true">// eslint-disable-line no-empty</span>

<span class="token keyword" >function</span> <span class="token function" >add</span><span class="token punctuation" >(</span>a<span class="token punctuation" >,</span> b<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> a <span class="token operator" >+</span> b<span class="token punctuation" >;</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >export</span> <span class="token punctuation" >{</span>
  add<span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >;</span>
</code></pre>
<p>To treat jQuery as an external, you should configure as follows:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >{</span>
  externals<span class="token punctuation" >:</span> <span class="token punctuation" >{</span>
    jquery<span class="token punctuation" >:</span> <span class="token string" >'jQuery'</span><span class="token punctuation" >,</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
<span class="token punctuation" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>If <code>libraryTarget: &#39;umd&#39;</code> is used after these changes, you get output:</p>
<pre><code class="lang-javascript"><span class="token punctuation" >(</span><span class="token keyword" >function</span> <span class="token function" >webpackUniversalModuleDefinition</span><span class="token punctuation" >(</span>root<span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span> <span class="token operator" >&amp;&amp;</span> <span class="token keyword" >typeof</span> module <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>
      <span class="token keyword" >function</span> <span class="token function" >webpackLoadOptionalExternalModule</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >try</span> <span class="token punctuation" >{</span> <span class="token keyword" >return</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >"jQuery"</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token punctuation" >}</span> <span class="token keyword" >catch</span><span class="token punctuation" >(</span>e<span class="token punctuation" >)</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> define <span class="token operator" >===</span> <span class="token string" >'function'</span> <span class="token operator" >&amp;&amp;</span> define<span class="token punctuation" >.</span>amd<span class="token punctuation" >)</span>
    <span class="token function" >define</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token string" >"jQuery"</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    exports<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>
      <span class="token keyword" >function</span> <span class="token function" >webpackLoadOptionalExternalModule</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >try</span> <span class="token punctuation" >{</span> <span class="token keyword" >return</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >"jQuery"</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token punctuation" >}</span> <span class="token keyword" >catch</span><span class="token punctuation" >(</span>e<span class="token punctuation" >)</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span>
    root<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span>root<span class="token punctuation" >[</span><span class="token string" >"jQuery"</span><span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span><span class="token keyword" >this</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span>__WEBPACK_EXTERNAL_MODULE_0__<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<span class="token keyword" >return</span> <span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>modules<span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token comment" spellcheck="true">// webpackBootstrap</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>Webpack wrapped the optional externals in <code>try</code>/<code>catch</code> blocks.</p>
<h3 class="header"><a class="header-anchor" href="#umd2" id="umd2"></a><span class="text"><code>umd2</code></span><a class="header-anchor-select" href="#umd2">#</a></h3>
<p>To understand what the <code>umd2</code> option does, consider the following output:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true">/*! fd0ace9 */</span>
<span class="token punctuation" >(</span><span class="token keyword" >function</span> <span class="token function" >webpackUniversalModuleDefinition</span><span class="token punctuation" >(</span>root<span class="token punctuation" >,</span> factory<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span> <span class="token operator" >&amp;&amp;</span> <span class="token keyword" >typeof</span> module <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    module<span class="token punctuation" >.</span>exports <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>
      <span class="token keyword" >function</span> <span class="token function" >webpackLoadOptionalExternalModule</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >try</span> <span class="token punctuation" >{</span> <span class="token keyword" >return</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >"jQuery"</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token punctuation" >}</span> <span class="token keyword" >catch</span><span class="token punctuation" >(</span>e<span class="token punctuation" >)</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> define <span class="token operator" >===</span> <span class="token string" >'function'</span> <span class="token operator" >&amp;&amp;</span> define<span class="token punctuation" >.</span>amd<span class="token punctuation" >)</span>
    <span class="token function" >define</span><span class="token punctuation" >(</span><span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span> <span class="token function" >webpackLoadOptionalExternalModuleAmd</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
      <span class="token keyword" >return</span> <span class="token function" >factory</span><span class="token punctuation" >(</span>root<span class="token punctuation" >[</span><span class="token string" >"jQuery"</span><span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
    <span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span> <span class="token keyword" >if</span><span class="token punctuation" >(</span><span class="token keyword" >typeof</span> exports <span class="token operator" >===</span> <span class="token string" >'object'</span><span class="token punctuation" >)</span>
    exports<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>
      <span class="token keyword" >function</span> <span class="token function" >webpackLoadOptionalExternalModule</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
        <span class="token keyword" >try</span> <span class="token punctuation" >{</span> <span class="token keyword" >return</span> <span class="token function" >require</span><span class="token punctuation" >(</span><span class="token string" >"jQuery"</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span> <span class="token punctuation" >}</span> <span class="token keyword" >catch</span><span class="token punctuation" >(</span>e<span class="token punctuation" >)</span> <span class="token punctuation" >{</span><span class="token punctuation" >}</span>
      <span class="token punctuation" >}</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword" >else</span>
    root<span class="token punctuation" >[</span><span class="token string" >"Demo"</span><span class="token punctuation" >]</span> <span class="token operator" >=</span> <span class="token function" >factory</span><span class="token punctuation" >(</span>root<span class="token punctuation" >[</span><span class="token string" >"jQuery"</span><span class="token punctuation" >]</span><span class="token punctuation" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation" >}</span><span class="token punctuation" >)</span><span class="token punctuation" >(</span><span class="token keyword" >this</span><span class="token punctuation" >,</span> <span class="token keyword" >function</span><span class="token punctuation" >(</span>__WEBPACK_EXTERNAL_MODULE_0__<span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
<span class="token keyword" >return</span> <span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>modules<span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token comment" spellcheck="true">// webpackBootstrap</span>
</code></pre>
<p>You can see one important difference: the AMD block contains more code than earlier. The output follows non-standard Knockout.js convention as <a href="https://github.com/webpack/webpack/pull/362">discussed in the related pull request</a>.</p>
<p>In most of the cases using <code>output.libraryTarget: &#39;umd&#39;</code> is enough as optional dependencies and AMD tend to be a rare configuration especially if you use modern technologies.</p>
<h2 class="header"><a class="header-anchor" href="#jsonp" id="jsonp"></a><span class="text">JSONP</span><a class="header-anchor-select" href="#jsonp">#</a></h2>
<p>There&#39;s one more output option: <code>jsonp</code>. It generates output as below:</p>
<pre><code class="lang-javascript"><span class="token function" >Demo</span><span class="token punctuation" >(</span><span class="token comment" spellcheck="true">/******/</span> <span class="token punctuation" >(</span><span class="token keyword" >function</span><span class="token punctuation" >(</span>modules<span class="token punctuation" >)</span> <span class="token punctuation" >{</span> <span class="token comment" spellcheck="true">// webpackBootstrap</span>
<span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>
</code></pre>
<p>In short, <code>output.library</code> maps to the JSONP function name. The idea is that you could load a file across domains and have it call the named function. Specific APIs implement the pattern although there is no official standard for it.</p>
<h2 class="header"><a class="header-anchor" href="#systemjs" id="systemjs"></a><span class="text">SystemJS</span><a class="header-anchor-select" href="#systemjs">#</a></h2>
<p><a href="https://www.npmjs.com/package/systemjs">SystemJS</a> is an emerging standard. <a href="https://www.npmjs.com/package/webpack-system-register">webpack-system-register</a> plugin allows you to wrap your output in a <code>System.register</code> call making it compatible with the scheme. If you want to support SystemJS this way, set up another build target.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Webpack supports a large variety of library output formats. <code>umd</code> is the most valuable for a package author. The rest are more specialized and require specific use cases to be valuable.</p>
<p>To recap:</p>
<ul>
<li>Most often <code>umd</code> is all you need. The other library targets exist more specialized usage in mind.</li>
<li>The CommonJS variants are handy if you target only Node or consume the output through bundlers alone. UMD implements support for CommonJS, AMD, and globals.</li>
<li>It&#39;s possible to target SystemJS through a plugin. Webpack does not support it out of the box.</li>
</ul>
<p>You&#39;ll learn to manage multi-page setups in the next chapter.</p>
</div><div class="social-links"><blockquote class="tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><h2 class="subscribe-header">Subscribe to the mailing list</h2><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;amp;id=b853b8e786" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate social-form" target="_blank" novalidate=""><div id="mc_embed_signup_scroll"><div class="mc-field-group social-input-container"><input type="email" placeholder="Email" value="" name="EMAIL" class="required email" id="mce-EMAIL"/></div><div style="display:none;position:absolute;left:-5000px;"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><div class="social-subscribe-container"><input type="submit" class="btn button social-subscribe" style="margin-top:1em;margin-bottom:1em;line-height:2em;" value="Subscribe" name="subscribe" id="mc-embedded-subscribe"/></div></div></form></div><div class="new-prevnext"><div class="new-prevnext__prev"><div class="new-prevnext__bg" style="background-image:url(/cc59e6eaf475b9ccc235a71c68036b96.jpg);"></div><span class="new-prevnext__info">Previous chapter</span><a class="new-prevnext__link" href="/webpack/output/bundling-libraries/">Bundling Libraries</a></div><div class="new-prevnext__next"><div class="new-prevnext__bg" style="background-image:url(/bfb2a0af5e20f281c7f1ab232cefa5d0.jpg);"></div><span class="new-prevnext__info">Next chapter</span><a class="new-prevnext__link" href="/webpack/output/multiple-pages/">Multiple Pages</a></div></div><blockquote class="tip"><p>This book is available through <a href="https://leanpub.com/survivejs-webpack">Leanpub (digital)</a>, <a href="https://www.amazon.com/dp/9526868803">Amazon (paperback)</a>, and <a href="https://www.amazon.com/dp/B06XWZZGBS">Kindle (digital)</a>. By purchasing the book you support the development of further content. A part of profit (~30%) goes to Tobias Koppers, the author of webpack.</p></blockquote><div id="disqus_thread"></div></div></div><div><a class="next-page" title="Multiple Pages" href="/webpack/output/multiple-pages/"><i class="icon-right-open"></i></a><a class="previous-page" title="Bundling Libraries" href="/webpack/output/bundling-libraries/"><i class="icon-left-open"></i></a></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div><div class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><nav class="nav"><div class="nav__link"><a href="/">Home</a></div><div class="nav__link"><a href="/blog/">Read the blog</a></div><div class="nav__link"><a href="/training/">Get training</a></div><div class="nav__link"><a href="https://leanpub.com/survivejs-webpack">Buy the ebook</a></div><div class="nav__link"><a href="/"></a></div><div class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></div></nav></div><footer><div class="footer-wrapper"><div class="footer-content-wrapper"><div class="footer-social"><h3>Social</h3><ul><li><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li></ul></div><div class="footer-blog"><h3>From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li><a class="blog-teaser" href="/blog/webexpo-2017/">Experiences on WebExpo 2017</a></li><li><a class="blog-teaser" href="/blog/kea-interview/">Kea - High level abstraction between React and Redux - Interview with Marius Andra</a></li><li><a class="blog-teaser" href="/blog/react-next-2017/">Experiences on React Next 2017</a></li><li><a class="blog-teaser" href="/blog/frint-interview/">FrintJS - Build reactive applications with React and RxJS - Interview with Fahad Ibnay Heylaal</a></li><li><a class="blog-teaser" href="/blog/neutrino-interview/">Neutrino - Create modern JavaScript applications with minimal configuration - Interview with Eli Perelman</a></li><li><a class="blog-teaser" href="/blog/idyll-interview/">Idyll - Narratives for the web - Interview with Matthew Conlen</a></li></ul></div></div></div></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '1182e3806d62e921613b8dc9c7a22ef3',
          indexName: 'survivejs_webpack',
          inputSelector: '#search',
          debug: false
        });
      </script></div></div>

    
  </body>
</html>
