<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="
When it comes to testing, often you assert certain truths.  At the very least you might have simple…" />
    <meta
      name="keywords"
      content="interview,react,testing" />
    <meta property="og:site_name" content="SurviveJS" />
    <meta property="og:title" content="Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen" />
    <meta property="og:description" content="
When it comes to testing, often you assert certain truths.  At the very least you might have simple…" />
    <meta name="twitter:title" content="Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen" />
    <meta name="twitter:description" content="
When it comes to testing, often you assert certain truths.  At the very least you might have simple…" />
    <meta name="twitter:site" content="@SurviveJS" />
    <title>Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.c285807bee3e6073c85f.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <header class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><a title="SurviveJS - Webpack and React - v2.0.0-rc3" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/blog/survivejs200-rc3/"><i class="icon-left-open"></i></a><nav class="nav"><ul class="nav__items"><li class="nav__link"><a href="https://graphql-finland.fi/">GraphQL Finland</a></li><li class="nav__link"><a href="/">Home</a></li><li class="nav__link nav__link_selected"><a href="/blog/">Read the blog</a></li><li class="nav__link"><a href="/maintenance/">Maintenance book</a></li><li class="nav__link"><a href="/react/">React book</a></li><li class="nav__link"><a href="/webpack/">Webpack book</a></li><li class="nav__link"><a href="/training/">Hire me</a></li><li class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></li></ul></nav><a title="Towards a Common Component Definition" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/blog/towards-common-components/"><i class="icon-right-open"></i></a></header><div class="page"><div class="css-b5dhuc css-8rlsag0"><div style="background-image:url(/022f437068bab1275214eeb3cd14bdb9.jpg)" class="css-1huzfyy css-8rlsag1"></div><h1 class="css-13wbkqf css-8rlsag2">Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</h1></div><div class="page__container"><div class="css-xfgthk css-20xtq50"><label for="sidebar-toggle" class="css-1whlnn6 css-20xtq52">Table of contents</label><input type="checkbox" id="sidebar-toggle" class="css-38lglc css-20xtq53"/><div class="css-nyzxad css-20xtq51"><div class="toc-nav__wrapper"><div><div><h4 class="toc-nav--header">Interviews</h4><ul class="toc-nav"><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/uppy-interview/">Uppy - Painless Uploads for JavaScript - Interview with Artur Paikin</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/graphql-finland-interview/">GraphQL Finland - Learn GraphQL Up North - Interview with Mikhail Novikov</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/pwa-interview/">Progressive Web Apps - The Why and How - Interview with Maciej Caputa</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/proppy-interview/">Proppy - Functional props composition for components - Interview with Fahad Ibnay Heylaal</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/fastpack-interview/">Fastpack - Pack JavaScript code fast and easy - Interview with Oleksiy Golovko</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/lint-staged-interview/">lint-staged - Run Linters on git Staged Files - Interview with Andrey Okonetchnikov</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/verdaccio-interview/">Verdaccio - A lightweight npm proxy registry - Interview with Juan Picado</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/parket-interview/">Parket - A state management library inspired by mobx-state-tree - Interview with Leah Ullmann</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/substyle-interview/">substyle - Build Styling Agnostic Components for React - Interview with Jan-Felix Schwarz</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/illuminate-interview/">Illuminate - Syntax highlighter for Node - Interview with Vivek Bansal</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/logux-interview/">Logux - Replace AJAX-REST - Interview with Andrey Sitnik</a></li></ul></div><div><h4 class="toc-nav--header">React</h4><ul class="toc-nav"><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/react-finland-interview/">React Finland - Your Chance to Learn React Up North - Interview with Juho Vepsäläinen</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/react-day-berlin-interview/">React Day Berlin - Fully Packed Day of Your Favorite React Content - Interview with Robert Haritonov</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/rekit-interview/">Rekit - Toolkit for building scalable React applications - Interview with Nate Wang</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/redux-first-router-interview/">Redux-First Router - Just dispatch actions - Interview with James Gillmore</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/rill-interview/">Rill - Universal web application framework - Interview with Dylan Piercey</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/material-ui-interview/">Material-UI - React Components that Implement Google&#x27;s Material Design - Interview with Olivier Tassinari</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/jss-interview/">JSS - Author CSS Using JavaScript as a Host Language - Interview with Oleg Slobodskoi</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/react-alicante-interview/">React Alicante - The international React.js conference in Spain - Interview with Victoria Quirante</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/vx-interview/">vx - The Power of D3 with the Benefits of React - Interview with Harrison Shoff</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/async-reactor-interview/">async-reactor - Render Async Stateless Functional Components in React - Interview with Sven Sauleau</a></li></ul></div><div><h4 class="toc-nav--header">Testing</h4><ul class="toc-nav"><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/lint-staged-interview/">lint-staged - Run Linters on git Staged Files - Interview with Andrey Okonetchnikov</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/redux-saga-test-plan-interview/">redux-saga-test-plan - Test Redux Saga with an easy plan - Interview with Jeremy Fairbank</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/cabbie-interview/">Cabbie - WebDriver for the masses - Interview with Forbes Lindesay</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/unexpected-react-interview/">unexpected-react - Test Full Virtual DOM - Interview with Dave Brotherstone</a></li><li class="toc-undefined"><a class="toc-nav__link undefined" href="/blog/codeceptjs-interview/">CodeceptJS - Modern Era Acceptance Testing for Node.js - Interview with Michael Bodnarchuk</a></li><li class="toc-undefined"><span class="toc-nav__link toc-nav__link--current undefined">Unexpected - The Extensible BDD Assertion Toolkit - Interview with Sune Simonsen</span></li></ul></div></div></div></div></div><div class="page__main"><div class="page__section"><time dateTime="2016-01-30T00:00:00.000Z" class="post__moment">30 Jan 2016</time><div><p>When it comes to testing, often you assert certain truths.  At the very least you might have simple <a href="https://nodejs.org/api/assert.html">asserts</a> sprinkled in your code. Or you might push them to separate suites which you then execute using a test runner.</p>
<p><a href="http://unexpected.js.org/">Unexpected</a> by <a href="https://twitter.com/sunesimonsen">Sune Simonsen</a> takes this simple idea into a little different direction. Read on to learn more.</p>
<h3 class="header"><a class="header-anchor" href="#can-you-tell-a-bit-about-yourself-" id="can-you-tell-a-bit-about-yourself-"></a><span class="text">Can you tell a bit about yourself?</span><a class="header-anchor-select" href="#can-you-tell-a-bit-about-yourself-">#</a></h3>
<p>
<span class="author">
  <img src="http://we-knowhow.dk/interview/sune-simonsen.png" alt="Sune Simonsen" class="author" width="100" height="100" />
</span>

I don&#39;t consider my personal life that exciting - or at least it is pretty far from your regular JavaScript hacker trying to start the next unicorn business from a dorm room. I am a family man with two small girls and a wife. We live a pretty regular and happy life in Copenhagen.
</p>

<p>I started my career as an enterprise Java consultant, after doing that for five years I saw the industry starting to take a turn towards the front-end being the orchestrating part in most applications. So I decided to change my career and focused on the front-end - that was one of the best decisions I have ever made.</p>
<p>Soon after this change, I started working at One.com. A great thing about working there was that it had a small team consisting of very talented people in charge of building most of their web applications. It was quite a large scale, and we had a lot of technical freedom, so I learned a lot from working there.</p>
<p>Little more than a year ago I switched jobs to Zendesk where I&#39;m currently building React applications backed by GraphQL. So far my journey with Zendesk has been incredible, it is a great company with so many fantastic people. Zendesk is moving fast, so it is also a lot of fun to be a passenger on this bullet train.</p>
<h2 class="header"><a class="header-anchor" href="#how-would-you-describe-unexpected-to-someone-who-has-never-heard-of-it-" id="how-would-you-describe-unexpected-to-someone-who-has-never-heard-of-it-"></a><span class="text">How would you describe <em>Unexpected</em> to someone who has never heard of it?</span><a class="header-anchor-select" href="#how-would-you-describe-unexpected-to-someone-who-has-never-heard-of-it-">#</a></h2>
<p><em>Unexpected</em> is an assertion library like <a href="http://chaijs.com/">Chai</a> or <a href="https://github.com/Automattic/expect.js">expect.js</a>. It can be used with any test runner that catches exceptions, but I would recommend <a href="http://mochajs.org/">Mocha</a>, <a href="https://facebook.github.io/jest/">Jest</a> or <a href="https://jasmine.github.io/">Jasmine</a> as Unexpected is integration tested with these runners on every release.</p>
<p>Below you can see an example of a test written with <em>Mocha</em> and <em>Unexpected</em> where we assert that the <code>indexOf</code> method on arrays returns <code>-1</code>, when it can&#39;t find the given element.</p>
<pre><code class="lang-javascript"><span class="token keyword keyword-const" >const</span> expect <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'unexpected'</span><span class="token punctuation brackets-parentheses" >)</span>

<span class="token function" >describe</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'Array'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
  <span class="token function" >describe</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'indexOf'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token function" >it</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'should return -1 when the given item is not present'</span><span class="token punctuation" >,</span>
      <span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
        <span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-square" >[</span><span class="token number" >0</span><span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >,</span> <span class="token number" >2</span><span class="token punctuation" >,</span> <span class="token number" >3</span><span class="token punctuation brackets-square" >]</span><span class="token punctuation" >.</span><span class="token function" >indexOf</span><span class="token punctuation brackets-parentheses" >(</span><span class="token number" >4</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >,</span> <span class="token string" >'to equal'</span><span class="token punctuation" >,</span> <span class="token operator" >-</span><span class="token number" >1</span><span class="token punctuation brackets-parentheses" >)</span>
      <span class="token punctuation brackets-braces" >}</span>
    <span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation brackets-braces" >}</span><span class="token punctuation brackets-parentheses" >)</span>
<span class="token punctuation brackets-braces" >}</span><span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<h2 class="header"><a class="header-anchor" href="#why-did-you-develop-unexpected-" id="why-did-you-develop-unexpected-"></a><span class="text">Why did you develop <em>Unexpected</em>?</span><a class="header-anchor-select" href="#why-did-you-develop-unexpected-">#</a></h2>
<p>When I came to One.com, there were no tests for the front-end, so I started introducing a test setup. We were using <a href="https://github.com/Automattic/expect.js">expect.js</a> as our assertion library and were happy with it. One of my colleagues started using <em>expect.js</em> for some randomized tests, and it happened to be very slow.</p>
<p>I investigated the performance issue and found that every <code>expect</code> would create 84 <code>Assertion</code> instances. In an attempt to impress my colleague, I hacked together the first version of <em>Unexpected</em> that was just a function backed by a hash table of assertions.</p>
<p>That version was as capable as <em>expect.js</em>, but a lot faster. The idea that made this possible was to use strings as assertions, instead of the method chains that <em>expect.js</em> uses. The following code snippet contrast the syntax of <em>expect.js</em> with <em>Unexpected</em>.</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true" >// expect.js</span>
<span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token number" >42</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >.</span>to<span class="token punctuation" >.</span>be<span class="token punctuation" >.</span><span class="token function" >within</span><span class="token punctuation brackets-parentheses" >(</span><span class="token number" >0</span><span class="token punctuation" >,</span> <span class="token number" >Infinity</span><span class="token punctuation brackets-parentheses" >)</span>

<span class="token comment" spellcheck="true" >// Unexpected</span>
<span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token number" >42</span><span class="token punctuation" >,</span> <span class="token string" >'to be within'</span><span class="token punctuation" >,</span> <span class="token number" >0</span><span class="token punctuation" >,</span> <span class="token number" >Infinity</span><span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<p>My team embraced the project and started using it for all JavaScript testing. That meant the library was improved based on real use cases as they appeared. Unexpected owes a lot to my former colleague at One.com, especially <a href="https://github.com/papandreou">Andreas Lind</a>.</p>
<h2 class="header"><a class="header-anchor" href="#how-does-unexpected-work-" id="how-does-unexpected-work-"></a><span class="text">How does <em>Unexpected</em> work?</span><a class="header-anchor-select" href="#how-does-unexpected-work-">#</a></h2>
<p>After almost four years of development <em>Unexpected</em>&#39;s implementation looks very different from the initial solution, we introduced custom assertions, a plugin API, an extremely flexible dynamic type system that allow you to namespace assertions by type, asynchronous assertions, colored output and error diffing in a way you have never seen before.</p>
<p>We still have an assertion lookup table, but as you can reuse the same assertion for several types, the lookup table maps to a list of assertions ordered by precedence. We look up the assertion string, find the first assertion that has a matching type signature and execute it. Below you can see an example of the same assertion string on two different types:</p>
<pre><code class="lang-javascript"><span class="token comment" spellcheck="true" >// Expect that a string contains two sub-strings</span>
<span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'Hello beautiful world!'</span><span class="token punctuation" >,</span> <span class="token string" >'to contain'</span><span class="token punctuation" >,</span> <span class="token string" >'Hello'</span><span class="token punctuation" >,</span> <span class="token string" >'world'</span><span class="token punctuation brackets-parentheses" >)</span>

<span class="token comment" spellcheck="true" >// Expect that an array contains two items</span>
<span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-square" >[</span><span class="token number" >0</span><span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >,</span> <span class="token number" >2</span><span class="token punctuation brackets-square" >]</span><span class="token punctuation" >,</span> <span class="token string" >'to contain'</span><span class="token punctuation" >,</span> <span class="token number" >0</span><span class="token punctuation" >,</span> <span class="token number" >2</span><span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<p>When you run the above code snippet, two different assertions will be called as the types differ.</p>
<h3 class="header"><a class="header-anchor" href="#built-with-extensibility-in-mind" id="built-with-extensibility-in-mind"></a><span class="text">Built with Extensibility in Mind</span><a class="header-anchor-select" href="#built-with-extensibility-in-mind">#</a></h3>
<p><em>Unexpected</em> is build with extensibility in mind from the ground up. All of the built-in assertions and types are installed as plugins. All assertions are defined by delegating to others except for one. I find this to be a very elegant solution.</p>
<p>As an example, the assertion <code>to be true</code> is defined the following way:</p>
<pre><code class="lang-javascript">expect<span class="token punctuation" >.</span><span class="token function" >addAssertion</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'&lt;boolean&gt; [not] to be true'</span><span class="token punctuation" >,</span>
  <span class="token punctuation brackets-parentheses" >(</span>expect<span class="token punctuation" >,</span> subject<span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span>subject<span class="token punctuation" >,</span> <span class="token string" >'[not] to be'</span><span class="token punctuation" >,</span> <span class="token boolean" >true</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation brackets-braces" >}</span>
<span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<h3 class="header"><a class="header-anchor" href="#output-through-magicpen" id="output-through-magicpen"></a><span class="text">Output Through MagicPen</span><a class="header-anchor-select" href="#output-through-magicpen">#</a></h3>
<p>Another implementation detail that might be interesting is that all output generated by <em>Unexpected</em> is created with a library that I wrote called <a href="https://github.com/sunesimonsen/magicpen">MagicPen</a>. The cool thing about <em>MagicPen</em> is that you append to a buffer, which has a very flexible API. It allows us to create very complex output quickly.</p>
<p>Because we append the output to a buffer in a high-level format, we can serialize the output to both plain text, ANSI colored text, and HTML.</p>
<p>Below you can see some output from an <em>Unexpected</em> error message generated by <em>MagicPen</em>:</p>
<p><figure><img src="/5415b1295875b657a22d6a1c2e78d247.png" alt="MagicPen output" class="" width="" height="" /><figcaption>MagicPen output</figcaption></figure></p>
<p>A lot of the output we generated with <em>Unexpected</em> would just be too hard without <em>MagicPen</em> in my opinion.</p>
<h2 class="header"><a class="header-anchor" href="#how-does-unexpected-differ-from-other-solutions-" id="how-does-unexpected-differ-from-other-solutions-"></a><span class="text">How does <em>Unexpected</em> differ from other solutions?</span><a class="header-anchor-select" href="#how-does-unexpected-differ-from-other-solutions-">#</a></h2>
<p><em>Unexpected</em> differ from other assertion libraries in a very obvious way by using a different syntax than all other assertion libraries I have seen. Using assertion strings was a coincidence that turned out to be fantastic.</p>
<h3 class="header"><a class="header-anchor" href="#strings-instead-of-method-chaining" id="strings-instead-of-method-chaining"></a><span class="text">Strings Instead of Method Chaining</span><a class="header-anchor-select" href="#strings-instead-of-method-chaining">#</a></h3>
<p>A lot of people get turned off by the different approach, but I think that it mainly comes down to familiarity. There are a lot of advantages of using strings instead of method chaining. We can display a helpful error message when you mistype something:</p>
<p><figure><img src="/d61f773548c67e4883eee30b52a6b7ef.png" alt="Unknown assertion" class="" width="" height="" /><figcaption>Unknown assertion</figcaption></figure></p>
<p>We can use assertion strings when adding new assertions:</p>
<pre><code class="lang-javascript">expect<span class="token punctuation" >.</span><span class="token function" >addAssertion</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'&lt;array&gt; [not] to be sorted'</span><span class="token punctuation" >,</span>
  <span class="token punctuation brackets-parentheses" >(</span>expect<span class="token punctuation" >,</span> subject<span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span>subject<span class="token punctuation" >,</span> <span class="token string" >'[not] to equal'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-square" >[</span><span class="token punctuation brackets-square" >]</span><span class="token punctuation" >.</span><span class="token function" >concat</span><span class="token punctuation brackets-parentheses" >(</span>subject<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >.</span><span class="token function" >sort</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation brackets-braces" >}</span>
<span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<p>Because we know your assertion we can generate a nice default error message for an assertion like this:</p>
<pre><code class="lang-javascript"><span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-square" >[</span><span class="token number" >2</span><span class="token punctuation" >,</span> <span class="token number" >1</span><span class="token punctuation" >,</span> <span class="token number" >3</span><span class="token punctuation brackets-square" >]</span><span class="token punctuation" >,</span> <span class="token string" >'to be sorted'</span><span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<p>And here&#39;s the resulting message:</p>
<p><figure><img src="/61a9498e8702e2264894d097ebeb737f.png" alt="Default error message" class="" width="" height="" /><figcaption>Default error message</figcaption></figure></p>
<h3 class="header"><a class="header-anchor" href="#faster-assertions-and-colored-output" id="faster-assertions-and-colored-output"></a><span class="text">Faster Assertions and Colored Output</span><a class="header-anchor-select" href="#faster-assertions-and-colored-output">#</a></h3>
<p><em>Unexpected</em> allows faster assertion lookup than a chained API due to its approach. Another thing that sets us apart from the rest of the assertions libraries is that we offer very specific colored output. Below you can see the output when comparing two buffers:</p>
<p><figure><img src="/7f67c660499c8312c5cabead3b18157f.png" alt="Buffer comparison" class="" width="" height="" /><figcaption>Buffer comparison</figcaption></figure></p>
<h3 class="header"><a class="header-anchor" href="#plugin-api" id="plugin-api"></a><span class="text">Plugin API</span><a class="header-anchor-select" href="#plugin-api">#</a></h3>
<p>We offer a much more powerful plugin API than other assertion libraries, that enables plugin authors to create support for new types and tools that we never planned.</p>
<p>An example of that is the excellent <a href="http://bruderstein.github.io/unexpected-react/">unexpected-react</a> plugin from <a href="https://twitter.com/bruderstein">Dave Brotherstone</a> that enables you to test React components in a declarative way and gives you very detailed errors when things fail.</p>
<p>Below you can see an error message from <code>unexpected-react</code>:</p>
<p><figure><img src="/aa456fda8979098e37b43cda37a5247b.png" alt="Unexpected with React" class="" width="" height="" /><figcaption>Unexpected with React</figcaption></figure></p>
<h3 class="header"><a class="header-anchor" href="#asynchronous-assertions" id="asynchronous-assertions"></a><span class="text">Asynchronous Assertions</span><a class="header-anchor-select" href="#asynchronous-assertions">#</a></h3>
<p>Finally <em>Unexpected</em> has first class support for asynchronous assertions. You can even combine multiple asynchronous assertions.</p>
<p>Below is an example showing a test that combines multiple asynchronous assertions. The test asserts that a Node.js readable stream outputs an image that&#39;s at most 10% different from a reference image and have the format <code>png</code>:</p>
<pre><code class="lang-javascript"><span class="token keyword keyword-const" >const</span> fs <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'fs'</span><span class="token punctuation brackets-parentheses" >)</span>
<span class="token keyword keyword-const" >const</span> expect <span class="token operator" >=</span> <span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'unexpected'</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >.</span><span class="token function" >clone</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation" >.</span><span class="token function" >use</span><span class="token punctuation brackets-parentheses" >(</span><span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'unexpected-stream'</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation" >.</span><span class="token function" >use</span><span class="token punctuation brackets-parentheses" >(</span><span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'unexpected-image'</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation" >.</span><span class="token function" >use</span><span class="token punctuation brackets-parentheses" >(</span><span class="token function" >require</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'unexpected-resemble'</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation brackets-parentheses" >)</span>

<span class="token function" >it</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'should spew out the expected image'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-parentheses" >(</span>
  <span class="token function" >expect</span><span class="token punctuation brackets-parentheses" >(</span>
    fs<span class="token punctuation" >.</span><span class="token function" >createReadStream</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'foo.png'</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >,</span>
    <span class="token string" >'to yield output satisfying'</span><span class="token punctuation" >,</span>
    expect<span class="token punctuation" >.</span><span class="token function" >it</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'to resemble'</span><span class="token punctuation" >,</span> <span class="token string" >'bar.png'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-braces" >{</span>
      mismatchPercentage<span class="token punctuation" >:</span> expect<span class="token punctuation" >.</span><span class="token function" >it</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'to be less than'</span><span class="token punctuation" >,</span> <span class="token number" >10</span><span class="token punctuation brackets-parentheses" >)</span>
    <span class="token punctuation brackets-braces" >}</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >.</span><span class="token function" >and</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'to have metadata satisfying'</span><span class="token punctuation" >,</span> <span class="token punctuation brackets-braces" >{</span>
      format<span class="token punctuation" >:</span> <span class="token string" >'PNG'</span>
    <span class="token punctuation brackets-braces" >}</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation brackets-parentheses" >)</span>
<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation brackets-parentheses" >)</span>
</code></pre>
<p>The cool thing is that you can choose how advanced you want to go, <em>Unexpected</em> won&#39;t stop you.</p>
<h2 class="header"><a class="header-anchor" href="#what-next-" id="what-next-"></a><span class="text">What next?</span><a class="header-anchor-select" href="#what-next-">#</a></h2>
<p>That is a splendid question. I feel like we have most of the features I would like by now, in my opinion, the energy should be put into improving the plugins. A lot of the contributors are meeting in Copenhagen in February to discuss how we continue to progress the library - so it going to be interesting what comes out of that.</p>
<h2 class="header"><a class="header-anchor" href="#what-does-the-future-look-like-for-unexpected-and-web-development-in-general-can-you-see-any-particular-trends-" id="what-does-the-future-look-like-for-unexpected-and-web-development-in-general-can-you-see-any-particular-trends-"></a><span class="text">What does the future look like for <em>Unexpected</em> and web development in general? Can you see any particular trends?</span><a class="header-anchor-select" href="#what-does-the-future-look-like-for-unexpected-and-web-development-in-general-can-you-see-any-particular-trends-">#</a></h2>
<p>I don&#39;t consider <em>Unexpected</em> to be especially aimed at web development but see it more as a general purpose assertion library that can be used to test any JavaScript code base.</p>
<p>Where I see <em>Unexpected</em> shine, is that it can be adapted to any code base by creating new plugins. You see a lot of assertion libraries tailored to testing JSX components, but then you need a new library when the trend changes.</p>
<h3 class="header"><a class="header-anchor" href="#optional-typing-is-getting-traction" id="optional-typing-is-getting-traction"></a><span class="text">Optional Typing is Getting Traction</span><a class="header-anchor-select" href="#optional-typing-is-getting-traction">#</a></h3>
<p>I currently following the optional typing trend like <a href="https://flowtype.org/">Flow</a> and <a href="https://www.typescriptlang.org/">TypeScript</a> with a bit of skepticism - but it seems to be getting a lot of traction. I think this movement will be a stepping stone towards stricter languages like <a href="https://facebook.github.io/reason/">Reason</a>, <a href="http://elm-lang.org/">Elm</a> or even <a href="http://www.purescript.org/">PureScript</a> as people realize the trade-offs these halfway safe type systems provides.</p>
<h3 class="header"><a class="header-anchor" href="#still-work-to-do" id="still-work-to-do"></a><span class="text">Still Work to Do</span><a class="header-anchor-select" href="#still-work-to-do">#</a></h3>
<p>I have a strong feeling that we haven&#39;t arrived at the perfect development tool-chain yet - React and friends have solved a lot of problems that was a huge struggle in the past. But this new world where people remix their platform with crazy metaprogramming achieved trough transpiling has to stop at some point.</p>
<p>My guess is that we will see something like <a href="https://facebook.github.io/reason/">Reason</a> being able to eliminate dead code in a much better way than any dynamic language and therefore provide much better download sizes. That might be the tipping point that will make the masses switch.</p>
<h2 class="header"><a class="header-anchor" href="#what-advice-would-you-give-to-programmers-getting-into-web-development-" id="what-advice-would-you-give-to-programmers-getting-into-web-development-"></a><span class="text">What advice would you give to programmers getting into web development?</span><a class="header-anchor-select" href="#what-advice-would-you-give-to-programmers-getting-into-web-development-">#</a></h2>
<p>Use your brain to evaluate new things you bring into your stack, don&#39;t just follow the hype blindly. You don&#39;t have to switch your approach to how you handle CSS every week just because your Twitter stream indicate that is the way it should be done.</p>
<p>When you create a side-project, decide upfront if you want to learn something new or want the project to succeed - you can&#39;t have both.</p>
<p>Use a queue instead of a stack in your brain to handle incoming side-projects - that is how you get something done. This advice was stolen from <a href="https://github.com/papandreou">Andreas Lind</a>, but it is the best advice I ever received.</p>
<p>When you run into problems with a library, make it a habit of contributing. You will realize that you can get fixes approved for most projects.</p>
<p>Surround yourself with people that are better than yourself. If you think you better then your co-workers, it is time to leave.</p>
<h2 class="header"><a class="header-anchor" href="#who-should-i-interview-next-" id="who-should-i-interview-next-"></a><span class="text">Who should I interview next?</span><a class="header-anchor-select" href="#who-should-i-interview-next-">#</a></h2>
<p><a href="https://github.com/papandreou">Andreas Lind</a> or <a href="https://github.com/mafintosh">Mathias Buus</a> they are both wizard level Danish JavaScript hackers.</p>
<h2 class="header"><a class="header-anchor" href="#any-last-remarks-" id="any-last-remarks-"></a><span class="text">Any last remarks?</span><a class="header-anchor-select" href="#any-last-remarks-">#</a></h2>
<p>Stay happy; it is only bits.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Thanks for the interview Sune! I think it&#39;s particularly impressive that you ended up with a nice, fluent plugin API. I&#39;m a great fan of plugin based systems myself and even though they require some upfront investment and design, they are often worth it if you value flexibility. Particularly the quality of output seems to set Unexpected apart.</p>
<p>To learn more, check out the <a href="http://unexpected.js.org/">site of Unexpected</a>. You can also find <a href="https://github.com/unexpectedjs/unexpected">Unexpected</a> and <a href="https://github.com/sunesimonsen/magicpen">MagicPen</a> on GitHub.</p>
</div><time dateTime="2016-01-30T00:00:00.000Z" class="post__moment">30 Jan 2016</time><div class="post__author"><a href="https://twitter.com/bebraw">Juho Vepsäläinen</a></div></div><div class="page__section"><div class="social-links"><h2 class="social-links__header">Subscribe to the blog updates</h2><blockquote class="tip social-links__tip">If you enjoyed this blog post, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" target="_blank" class="css-1nfeoes css-va8n550"><input type="email" class="css-baseStyle-s4lgck css-inputStyle-16d70pc" placeholder="Email" name="EMAIL" id="mce-EMAIL" required=""/><div style="display:none;position:absolute;left:-5000px"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><input type="submit" class="css-baseStyle-s4lgck css-buttonStyle-1y781j1" value="Subscribe" name="subscribe"/></form></div><div class="css-r9vozr css-7ic71f0"><div class="css-panel-1asgzqv css-panelPrev-h368eu"><div class="css-1njlj0m css-7ic71f1">Previous post</div><a class="css-link-h8hsyv css-linkPrev-966ksh" href="/blog/survivejs200-rc3/">SurviveJS - Webpack and React - v2.0.0-rc3</a></div><div class="css-panel-1asgzqv css-panelNext-1i6c957"><div class="css-1njlj0m css-7ic71f1">Next post</div><a class="css-link-h8hsyv css-linkNext-1a0mc68" href="/blog/towards-common-components/">Towards a Common Component Definition</a></div></div><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div></div></div></div><footer class="css-eo7znu css-iscbe10"><ul class="css-jtawwa css-iscbe13 css-6482o6 css-3yjlwf0"><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="/atom.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><div class="css-1gd1yml css-iscbe11"><h3 class="css-oi3rzz css-iscbe12">From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/uppy-interview/">Uppy - Painless Uploads for JavaScript - Interview with Artur Paikin</a></li><li><a class="blog-teaser" href="/blog/graphql-finland-interview/">GraphQL Finland - Learn GraphQL Up North - Interview with Mikhail Novikov</a></li><li><a class="blog-teaser" href="/blog/pwa-interview/">Progressive Web Apps - The Why and How - Interview with Maciej Caputa</a></li><li><a class="blog-teaser" href="/blog/proppy-interview/">Proppy - Functional props composition for components - Interview with Fahad Ibnay Heylaal</a></li><li><a class="blog-teaser" href="/blog/summer-2018-events/">SurviveJS - Summer Events</a></li><li><a class="blog-teaser" href="/blog/fastpack-interview/">Fastpack - Pack JavaScript code fast and easy - Interview with Oleksiy Golovko</a></li><li><a class="blog-teaser" href="/blog/lint-staged-interview/">lint-staged - Run Linters on git Staged Files - Interview with Andrey Okonetchnikov</a></li></ul></div><ul aria-label="Other Juho&#x27;s books" class="css-6482o6 css-3yjlwf0"><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/maintenance/introduction"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - Maintenance: Streamline JavaScript Workflow</h4><img alt="Maintenance book cover" src="/2900d9b74e46ac6cdf984148c1a0c631.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-maintenance">Buy at Leanpub</a></li><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/react/introduction"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - React: From apprentice to master</h4><img alt="React book cover" src="/2412b7150d25c1dc3c309666132bc26e.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></li><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/webpack/foreword"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - Webpack: From apprentice to master</h4><img alt="Webpack book cover" src="/20cf3367cf445212a90411ccd2282229.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></li></ul></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div>

    
  </body>
</html>
