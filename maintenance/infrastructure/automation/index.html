<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="
Everything that can be done by a machine, will eventually be done by a machine. One of the earliest…" />
    <meta
      name="keywords"
      content="" />
    <meta property="og:site_name" content="SurviveJS" />
    <meta property="og:title" content="Automation" />
    <meta property="og:description" content="
Everything that can be done by a machine, will eventually be done by a machine. One of the earliest…" />
    <meta name="twitter:title" content="Automation" />
    <meta name="twitter:description" content="
Everything that can be done by a machine, will eventually be done by a machine. One of the earliest…" />
    <meta name="twitter:site" content="@SurviveJS" />
    <title>Automation</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.438f274a1ffdc06f5b75.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <header class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><a title="Continuous Integration" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/maintenance/infrastructure/continuous-integration/"><i class="icon-left-open"></i></a><nav class="nav"><ul class="nav__items"><li class="nav__link"><a href="https://graphql-finland.fi/">GraphQL Finland</a></li><li class="nav__link"><a href="/">Home</a></li><li class="nav__link"><a href="/blog/">Read the blog</a></li><li class="nav__link nav__link_selected"><a href="/maintenance/">Maintenance book</a></li><li class="nav__link"><a href="/react/">React book</a></li><li class="nav__link"><a href="/webpack/">Webpack book</a></li><li class="nav__link"><a href="/training/">Hire me</a></li><li class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></li></ul></nav><a title="Documentation" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/maintenance/documentation/"><i class="icon-right-open"></i></a></header><div class="page"><div class="css-b5dhuc css-8rlsag0"><div style="background-image:url(/739f31bc4e0424d31760aac7e7df200e.jpg)" class="css-1huzfyy css-8rlsag1"></div><h1 class="css-13wbkqf css-8rlsag2">Automation</h1><small aria-hidden="true" class="css-18xzi2i css-8rlsag3"><a href="https://pixabay.com/en/robot-arm-technology-robot-arm-2791670/">jarmoluk (Public Domain)</a></small></div><div class="page__container"><div class="css-xfgthk css-20xtq50"><label for="sidebar-toggle" class="css-1whlnn6 css-20xtq52">Table of contents</label><input type="checkbox" id="sidebar-toggle" class="css-38lglc css-20xtq53"/><div class="css-nyzxad css-20xtq51"><div class="toc-nav__wrapper"><div class="toc-nav__section"><input id="search" class="toc-nav__search" placeholder="Search"/></div><div class="toc-nav__section"><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/introduction/">Introduction</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/packaging/">Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/where-to-start/">Where to Start Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/anatomy/">Anatomy of a Package</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/publishing/">Publishing Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/building/">Building Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/standalone-builds/">Standalone Builds</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/managing-dependencies/">Managing Dependencies</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/code-quality/">Code Quality</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/linting/">Linting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/code-formatting/">Code Formatting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/typing/">Typing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/testing/">Testing</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/infrastructure/">Infrastructure</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/processes/">Processes</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/continuous-integration/">Continuous Integration</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Automation</span></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/documentation/">Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/readme/">README</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/change-log/">Change Logs</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/site/">Site</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/api/">API Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/misc/">Other Types of Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/linting/">Linting and Formatting</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/future/">Future</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/longevity/">Longevity</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/marketing/">Marketing</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/appendices/">Appendices</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/appendices/monorepos/">Managing Packages Using a Monorepo</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/appendices/customizing-eslint/">Customizing ESLint</a></li></ul></div><div class="toc-nav__section"></div></div></div></div><div class="page__main"><div class="page__section"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/webcampzg-2018/">Experiences on WebCamp Zagreb 2018</a></blockquote></div><div class="chapter-content"><p>Everything that can be done by a machine, will eventually be done by a machine. One of the earliest &quot;computers&quot;, <a href="https://en.wikipedia.org/wiki/Jacquard_loom">the Jacquard machine</a>, achieved this for manufacturing complex textiles. It displaced human effort this way and pushed the difficult and monotonous task to a machine. This is the whole point of automation.</p>
<p>The same idea applies to software projects. Why to repeatedly do something that you can have the machine do for you? Or why to do something the hard way when it’s possible to do it in an easier way while having the machine to assist you?</p>
<h2 class="header"><a class="header-anchor" href="#git-commit-messages" id="git-commit-messages"></a><span class="text">Git Commit Messages</span><a class="header-anchor-select" href="#git-commit-messages">#</a></h2>
<p>Depending on the developer and the development style, the quality of Git commit messages can vary. It’s important data given it may be used in the future as you have to figure out why some code was written the way it was. The quality of commit messages becomes important when more people get involved with the project.</p>
<h3 class="header"><a class="header-anchor" href="#commit-message-conventions" id="commit-message-conventions"></a><span class="text">Commit Message Conventions</span><a class="header-anchor-select" href="#commit-message-conventions">#</a></h3>
<p>Especially <a href="https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y">AngularJS commit message convention</a> has gained popularity in the JavaScript community. The ideas have been formalized in <a href="https://conventionalcommits.org/">the Conventional Commits specification</a>.</p>
<p>The idea is to provide context to a commit. This enables effective filtering of Git log and it keeps the log tidy. Given the convention is standard, it has lead to tooling that can for example generate change logs for releases or even handle whole release process for you.</p>
<p>To make it easier to follow the aforementioned conventions, <a href="https://www.npmjs.com/package/commitizen">commitizen</a> gives a specific command, <code>git cz</code>. It asks you a series of questions and then fills the message with the correct information. This way you don’t have to remember the specification in detail and you will gradually learn it.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Internally commitizen relies upon <a href="https://github.com/marionebl/commitlint">commitlint</a>. commitlint provides a tool you can use to validate messages. commitizen wraps it in a higher level interface.</blockquote><h3 class="header"><a class="header-anchor" href="#angularjs-commit-message-convention" id="angularjs-commit-message-convention"></a><span class="text">AngularJS Commit Message Convention</span><a class="header-anchor-select" href="#angularjs-commit-message-convention">#</a></h3>
<p>In AngularJS convention each commit message consists of:</p>
<ul>
<li>Type: <code>feat</code> for a new feature, <code>fix</code> for a bug fix, <code>docs</code> for documentation, <code>chore</code> for maintenance, etc.</li>
<li>Subject: short change description.</li>
<li>Body (optional): long change description.</li>
<li>Footer (optional): breaking changes, GitHub issues references, etc.</li>
</ul>
<p>For example:</p>
<pre><code class="lang-bash">feat<span class="token punctuation brackets-parentheses" >(</span><span class="token variable" >$compile</span><span class="token punctuation brackets-parentheses" >)</span>: simplify isolate scope bindings

Changed the isolate scope binding options to:
  - @attr - attribute binding <span class="token punctuation brackets-parentheses" >(</span>including interpolation<span class="token punctuation brackets-parentheses" >)</span>
  - <span class="token operator" >=</span>model - by-directional model binding
  - <span class="token operator" >&amp;</span><span class="token function" >expr</span> - expression execution binding

This change simplifies the terminology as well as
number of choices available to the developer. It
also supports local name aliasing from the parent.

BREAKING CHANGE: isolate scope bindings definition has changed and
the inject option <span class="token keyword keyword-for" >for</span> the directive controller injection was removed.

To migrate the code follow the example below:

Before:

scope: <span class="token punctuation brackets-braces" >{</span>
  myAttr: <span class="token string" >'attribute'</span>,
  myBind: <span class="token string" >'bind'</span>,
  myExpression: <span class="token string" >'expression'</span>,
  myEval: <span class="token string" >'evaluate'</span>,
  myAccessor: <span class="token string" >'accessor'</span>
<span class="token punctuation brackets-braces" >}</span>

After:

scope: <span class="token punctuation brackets-braces" >{</span>
  myAttr: <span class="token string" >'@'</span>,
  myBind: <span class="token string" >'@'</span>,
  myExpression: <span class="token string" >'&amp;'</span>,
  // myEval - usually not useful, but <span class="token keyword keyword-in" >in</span> cases where the expression is assignable, you can use <span class="token string" >'='</span>
  myAccessor: <span class="token string" >'='</span> // <span class="token keyword keyword-in" >in</span> directive's template change myAccessor<span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span> to myAccessor
<span class="token punctuation brackets-braces" >}</span>
</code></pre>
<p>Messages can be descriptive like this when they capture a big change. During development smaller messages representing meaningful changes are enough. Messages as the one above can be written as the work gets merged to the release branch of the project.</p>
<p>The advantage of doing this is that it makes it easier for other developers to tell what’s going on. Some of the information can be reused for documentation purposes in project main documentation and change logs.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>It’s a common convention to write commit titles in <strong>imperative</strong> tense. The main reason is that this keeps the results of <code>git diff</code> more understandable to other developers. <a href="https://chris.beams.io/posts/git-commit/">Chris Beams explains the message idea in detail in his blog</a>.</blockquote><h2 class="header"><a class="header-anchor" href="#semantic-release" id="semantic-release"></a><span class="text">Semantic Release</span><a class="header-anchor-select" href="#semantic-release">#</a></h2>
<p>By default semantic-release makes everything automatically:</p>
<ul>
<li>Runs on a CI server after each commit to the <code>master</code> branch.</li>
<li>After each successful build it analyzes new commits and see if there’s something to publish.</li>
<li>Determines a release type (PATCH, MINOR or MAJOR) by analyzing commit messages written using AngularJS conventions.</li>
<li>Generates a change log from important commits (skips documentation and maintenance commits).</li>
<li>Publishes a new package version to npm.</li>
<li>Publishes change log to GitHub Releases page.</li>
</ul>
<p>To use semantic-release you need to install its command line tool:</p>
<pre><code class="lang-bash"><span class="token function" >npm</span> <span class="token function" >install</span> -g semantic-release-cli
</code></pre>
<p>Then run it in your project folder:</p>
<pre><code class="lang-bash">semantic-release-cli setup
</code></pre>
<p>Enter your npm and GitHub credentials, choose type of your CI server.</p>
<p>And now if you make a new commit with a message like <code>fix: allow doodad to work with zero</code>, semantic-release will publish a new PATCH version to npm and publish release notes to GitHub.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>You can customize every step of this process with plugins. For example, <a href="http://blog.sapegin.me/all/semantic-release">make only PATCH releases automatically</a> and allow user to decide when to make MINOR and MAJOR releases and edit change logs manually.</blockquote><blockquote class="tip"><i class="icon-attention-circled"></i>Look into <a href="https://www.npmjs.com/package/standard-version">standard-release</a> and <a href="https://www.npmjs.com/package/unleash">unleash</a> for alternatives.</blockquote><h2 class="header"><a class="header-anchor" href="#git-hooks" id="git-hooks"></a><span class="text">Git Hooks</span><a class="header-anchor-select" href="#git-hooks">#</a></h2>
<p>Git provides a set of hooks that trigger for example before pushing or committing a change. These hooks are ideal for quick checks and they allow you to adjust your source before finally pushing by using <code>git rebase --interactive</code> (or <code>git rebase -i</code>). Rebase workflow is good to know as it allows you to fix mistakes before they get shared with other developers.</p>
<p>Git hooks can be used in a JavaScript project with a package such as <a href="https://www.npmjs.com/package/husky">husky</a>. It connects Git hook interface with npm <code>scripts</code>. Consider the example below:</p>
<p><strong>package.json</strong></p>
<pre><code class="lang-json"><span class="token property" >"scripts"</span><span class="token operator" >:</span> <span class="token punctuation brackets-braces" >{</span>
  ...
  <span class="token property" >"prepush"</span><span class="token operator" >:</span> <span class="token string" >"npm test"</span>
<span class="token punctuation brackets-braces" >}</span><span class="token punctuation" >,</span>
</code></pre>
<p>The package will do all the wiring required and run project tests before pushing to the repository.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Note that if you have set up Git hooks manually, it might not work! It’s better to let husky control the Git side entirely.</blockquote><h2 class="header"><a class="header-anchor" href="#automating-linting-with-lint-staged" id="automating-linting-with-lint-staged"></a><span class="text">Automating Linting With lint-staged</span><a class="header-anchor-select" href="#automating-linting-with-lint-staged">#</a></h2>
<p><a href="https://github.com/okonet/lint-staged">lint-staged</a> runs linters only for changed files before each commit which makes linting mandatory and fast. It uses <code>pre-commit</code> Git hook and you can map any file extension to a shell command. You can also configure it to autofix code.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>lint-staged works with <a href="https://github.com/facebook/flow/releases/tag/v0.48.0">Flow since v0.48.0</a>.</blockquote><blockquote class="warning"><i class="icon-attention"></i>You still need to run linters on your CI server: it’s possible to avoid the <code>pre-commit</code> hook with <code>git commit --no-verify</code> in the GitHub UI.</blockquote><h3 class="header"><a class="header-anchor" href="#setting-up-lint-staged" id="setting-up-lint-staged"></a><span class="text">Setting up lint-staged</span><a class="header-anchor-select" href="#setting-up-lint-staged">#</a></h3>
<p>Let’s install lint-staged and <a href="https://www.npmjs.com/package/husky">husky</a> to manage Git hooks:</p>
<pre><code class="lang-bash"><span class="token function" >npm</span> <span class="token function" >install</span> lint-staged husky --save-dev
</code></pre>
<p>Update your <em>package.json</em> like this:</p>
<p><strong>package.json</strong></p>
<pre><code class="lang-json"><span class="token punctuation brackets-braces" >{</span>
  <span class="token property" >"scripts"</span><span class="token operator" >:</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token property" >"precommit"</span><span class="token operator" >:</span> <span class="token string" >"lint-staged"</span>
  <span class="token punctuation brackets-braces" >}</span><span class="token punctuation" >,</span>
  <span class="token property" >"lint-staged"</span><span class="token operator" >:</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token property" >"*.js"</span><span class="token operator" >:</span> <span class="token punctuation brackets-square" >[</span>
      <span class="token string" >"eslint --fix"</span><span class="token punctuation" >,</span>
      <span class="token string" >"jest --bail --findRelatedTests"</span><span class="token punctuation" >,</span>
      <span class="token string" >"prettier --write"</span><span class="token punctuation" >,</span>
      <span class="token string" >"git add"</span>
    <span class="token punctuation brackets-square" >]</span><span class="token punctuation" >,</span>
    <span class="token property" >"*.scss"</span><span class="token operator" >:</span> <span class="token punctuation brackets-square" >[</span><span class="token string" >"stylelint --fix"</span><span class="token punctuation" >,</span> <span class="token string" >"prettier --write"</span><span class="token punctuation" >,</span> <span class="token string" >"git add"</span><span class="token punctuation brackets-square" >]</span>
  <span class="token punctuation brackets-braces" >}</span>
<span class="token punctuation brackets-braces" >}</span>
</code></pre>
<p>This configuration will perform the following steps:</p>
<p><strong>Every time you commit a <em>.js</em> file:</strong></p>
<ol>
<li>Run ESLint with autofixing on files you are committing.</li>
<li>Run Jest tests related to files you are committing.</li>
<li>Format files you are committing with Prettier.</li>
<li>Add changes caused by autofixing and reformatting to your commit.</li>
</ol>
<p><strong>Every time you commit an <em>.scss</em> file:</strong></p>
<ol>
<li>Run stylelint with autofixing on files you are committing.</li>
<li>Format files you are committing with Prettier.</li>
<li>Add changes caused by reformatting to your commit.</li>
</ol>
<blockquote class="tip"><i class="icon-attention-circled"></i>Read more about Prettier in the <a href="/maintenance/code-quality/code-formatting/">Code Formatting</a> chapter.</blockquote><h2 class="header"><a class="header-anchor" href="#automating-releases" id="automating-releases"></a><span class="text">Automating Releases</span><a class="header-anchor-select" href="#automating-releases">#</a></h2>
<p>To make it easier to manage SemVer, <a href="https://www.npmjs.com/package/next-ver">next-ver</a> can compute the next version you should use and update it for you. <a href="https://www.npmjs.com/package/commitizen">commitizen</a> goes further and allows change log generation and automated releases. <a href="https://www.npmjs.com/package/semantic-release">semantic-release</a> allows you to automatically make new npm releases and publish release notes to GitHub.</p>
<p>All these tools rely on commit message convention.</p>
<h2 class="header"><a class="header-anchor" href="#gh-lint" id="gh-lint"></a><span class="text">gh-lint</span><a class="header-anchor-select" href="#gh-lint">#</a></h2>
<p><a href="https://www.npmjs.com/package/gh-lint">https://www.npmjs.com/package/gh-lint</a></p>
<h2 class="header"><a class="header-anchor" href="#danger" id="danger"></a><span class="text">Danger</span><a class="header-anchor-select" href="#danger">#</a></h2>
<p><a href="https://github.com/danger/danger-js">Danger JS</a> runs as a part of your CI script, can validate common code review requirements and fail the CI if they aren’t met.</p>
<p>For example:</p>
<ul>
<li>Require to update the npm lockfile every time <em>package.json</em> changes.</li>
<li>Require new tests when new code is added.</li>
<li>Require a change log entry.</li>
<li>Check for test shortcuts like <code>it.only</code> or <code>describe.only</code>.</li>
<li>Check for <code>TODO</code> and <code>FIXME</code> comments.</li>
<li>Check that the pull request was sent to a correct branch.</li>
<li>Check number of changed lines and suggest to split the pull request if it’s too big.</li>
<li>Check that new files have a proper copyright message.</li>
<li>Welcome first time contributors to your project.</li>
<li>Ping specific people on changes in specific files.</li>
</ul>
<p>Danger has no default rules but it has a JavaScript API that allows you to inspect source code changes, pull request metadata, build log, post comments on the pull request and mark the build as failed.</p>
<blockquote class="tip"><i class="icon-attention-circled"></i>Two good examples of relatively complex Dangerfiles are <a href="https://github.com/styled-components/styled-components/blob/master/dangerfile.js">Styled Components</a> and <a href="https://github.com/ReactiveX/rxjs/blob/master/dangerfile.js">RxJS</a>.</blockquote><p>To use Danger you need a GitHub bot user. Each GitHub user is allowed to create one bot user. You do it the same way you’ve created your own account but you can use this user for automation, like posting comments using a script.</p>
<p>Let’s install Danger:</p>
<pre><code class="lang-bash"><span class="token function" >npm</span> <span class="token function" >install</span> --save-dev danger
</code></pre>
<p>Create a Dangerfile, <em>dangerfile.js</em> in your project root folder, like this:</p>
<pre><code class="lang-js"><span class="token keyword keyword-import" >import</span> <span class="token punctuation brackets-braces" >{</span> danger<span class="token punctuation" >,</span> warn<span class="token punctuation" >,</span> fail <span class="token punctuation brackets-braces" >}</span> <span class="token keyword keyword-from" >from</span> <span class="token string" >'danger'</span><span class="token punctuation" >;</span>

<span class="token comment" spellcheck="true" >// Warn (won’t fail the CI, just post a comment) if the PR has</span>
<span class="token comment" spellcheck="true" >// changes in package.json but no changes in package-lock.json</span>
<span class="token keyword keyword-const" >const</span> packageChanged <span class="token operator" >=</span> danger<span class="token punctuation" >.</span>git<span class="token punctuation" >.</span>modified_files<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation brackets-parentheses" >(</span>
  <span class="token string" >'package.json'</span>
<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
<span class="token keyword keyword-const" >const</span> lockfileChanged <span class="token operator" >=</span> danger<span class="token punctuation" >.</span>git<span class="token punctuation" >.</span>modified_files<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation brackets-parentheses" >(</span>
  <span class="token string" >'package-lock.json'</span>
<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
<span class="token keyword keyword-if" >if</span> <span class="token punctuation brackets-parentheses" >(</span>packageChanged <span class="token operator" >&amp;&amp;</span> <span class="token operator" >!</span>lockfileChanged<span class="token punctuation brackets-parentheses" >)</span> <span class="token punctuation brackets-braces" >{</span>
  <span class="token function" >warn</span><span class="token punctuation brackets-parentheses" >(</span>
    <span class="token string" >'Changes were made to package.json, but not to '</span> <span class="token operator" >+</span>
      <span class="token string" >'package-lock.json.'</span> <span class="token operator" >+</span>
      <span class="token string" >'Perhaps you need to run `npm install` and commit changes '</span> <span class="token operator" >+</span>
      <span class="token string" >'in package-lock.json. Make sure you’re using npm 5+.'</span>
  <span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
<span class="token punctuation brackets-braces" >}</span>

<span class="token comment" spellcheck="true" >// Fail the CI when test shorcuts are found</span>
<span class="token keyword keyword-const" >const</span> jsTestChanges <span class="token operator" >=</span> danger<span class="token punctuation" >.</span>git<span class="token punctuation" >.</span>modified_files<span class="token punctuation" >.</span><span class="token function" >filter</span><span class="token punctuation brackets-parentheses" >(</span>f <span class="token operator" >=&gt;</span>
  f<span class="token punctuation" >.</span><span class="token function" >endsWith</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'.spec.js'</span><span class="token punctuation brackets-parentheses" >)</span>
<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
jsTestChanges<span class="token punctuation" >.</span><span class="token function" >forEach</span><span class="token punctuation brackets-parentheses" >(</span>file <span class="token operator" >=&gt;</span> <span class="token punctuation brackets-braces" >{</span>
  <span class="token keyword keyword-const" >const</span> content <span class="token operator" >=</span> fs<span class="token punctuation" >.</span><span class="token function" >readFileSync</span><span class="token punctuation brackets-parentheses" >(</span>file<span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >.</span><span class="token function" >toString</span><span class="token punctuation brackets-parentheses" >(</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
  <span class="token keyword keyword-if" >if</span> <span class="token punctuation brackets-parentheses" >(</span>
    content<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'it.only'</span><span class="token punctuation brackets-parentheses" >)</span> <span class="token operator" >||</span>
    content<span class="token punctuation" >.</span><span class="token function" >includes</span><span class="token punctuation brackets-parentheses" >(</span><span class="token string" >'describe.only'</span><span class="token punctuation brackets-parentheses" >)</span>
  <span class="token punctuation brackets-parentheses" >)</span> <span class="token punctuation brackets-braces" >{</span>
    <span class="token function" >fail</span><span class="token punctuation brackets-parentheses" >(</span><span class="token template-string" ><span class="token string" >`An \`.only\` was left in tests (</span><span class="token interpolation" ><span class="token interpolation-punctuation punctuation" >${</span>file<span class="token interpolation-punctuation punctuation" >}</span></span><span class="token string" >)`</span></span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
  <span class="token punctuation brackets-braces" >}</span>
<span class="token punctuation brackets-braces" >}</span><span class="token punctuation brackets-parentheses" >)</span><span class="token punctuation" >;</span>
</code></pre>
<p>Update your <em>.travis.yml</em> to make it run on Travis CI:</p>
<pre><code class="lang-yaml"><span class="token key atrule" >language</span><span class="token punctuation" >:</span> node_js
<span class="token key atrule" >node_js</span><span class="token punctuation" >:</span>
  <span class="token punctuation" >-</span> <span class="token number" >8</span>
<span class="token key atrule" >script</span><span class="token punctuation" >:</span>
  npm run test
  npx danger ci
</code></pre>
<p>You also need to add API token to Travis settings, see <a href="http://danger.systems/js/guides/getting_started.html">getting started guide</a> for details.</p>
<p>Now every time someone sends a pull request that changes <em>package.json</em> but not <em>package-lock.json</em>, the bot will warn them:</p>
<p><figure><img src="/3f30ff15450bee43758900d0b8bd9fd9.png" alt="Danger JS comment" class="" width="" height="" /><figcaption>Danger JS comment</figcaption></figure></p>
<p>Danger has some plugins, like:</p>
<ul>
<li><a href="https://www.npmjs.com/package/danger-plugin-fixme">fixme</a> — check for <code>TODO</code> and <code>FIXME</code> comments;</li>
<li><a href="https://www.npmjs.com/package/danger-plugin-no-test-shortcuts">no-test-shortcuts</a> — check for test shortcuts;</li>
<li><a href="https://www.npmjs.com/package/danger-plugin-spellcheck">spellcheck</a> — spell checks created or modified Markdown files.</li>
</ul>
<h2 class="header"><a class="header-anchor" href="#configuration-automation" id="configuration-automation"></a><span class="text">Configuration Automation</span><a class="header-anchor-select" href="#configuration-automation">#</a></h2>
<p>Most of the tools described in this book require some configuration. But maintaining this configuration is far from easy, especially if you want up-to-date configs in all your projects.</p>
<p><a href="https://github.com/sapegin/mrm">Mrm</a> tries to solve this problem. It works like <a href="https://www.sitepoint.com/getting-started-with-codemods/">codemods</a>: it doesn’t use templates that would overwrite everything, you’re describing in code how to <em>modify</em> or create files to achieve the desired state.</p>
<p>Mrm has <a href="https://github.com/sapegin/mrm-tasks/tree/master/packages/mrm-preset-default">many tasks</a> out of the box: CodeCov, EditorConfig, ESLint, .gitignore, Jest, lint-staged, Prettier, semantic-release, React Styleguidist, stylelint, Travis CI, TypeScript, package.json, contributing guidelines, license and readme file. You can create your own task or combine multiple tasks using aliases.</p>
<p>Mrm tries to do minimal changes by inferring indentation style or read it from the EditorConfig and keeping comments in JSON files. It has minimal required configuration by inferring values from the project itself or from the environment, like reading your name and email from your Git or npm configs.</p>
<p>Mrm has utilities to work with the most popular config file formats: JSON, YAML, INI and new line separated text files; install and uninstall npm modules; and file operations.</p>
<p>Let’s install Mrm:</p>
<pre><code class="lang-bash"><span class="token function" >npm</span> <span class="token function" >install</span> -g mrm
</code></pre>
<p>And run like this:</p>
<pre><code class="lang-bash">mrm gitignore
mrm license --config:licenseFile README
</code></pre>
<p>Optionally, create a config file at <code>~/.mrm/config.json</code> or <code>~/dotfiles/mrm/config.json</code> instead of passing values via command line:</p>
<pre><code class="lang-json5"><span class="token punctuation brackets-braces" >{</span>
  <span class="token property" >"github"</span><span class="token operator" >:</span> <span class="token string" >"sapegin"</span><span class="token punctuation" >,</span>
  <span class="token property" >"eslintPreset"</span><span class="token operator" >:</span> <span class="token string" >"airbnb"</span><span class="token punctuation" >,</span>
  <span class="token property" >"aliases"</span><span class="token operator" >:</span> <span class="token punctuation brackets-braces" >{</span>
    // Aliases to run multiple tasks at once
    <span class="token property" >"node"</span><span class="token operator" >:</span> <span class="token punctuation brackets-square" >[</span><span class="token string" >"license"</span><span class="token punctuation" >,</span> <span class="token string" >"readme"</span><span class="token punctuation" >,</span> <span class="token string" >"editorconfig"</span><span class="token punctuation" >,</span> <span class="token string" >"gitignore"</span><span class="token punctuation brackets-square" >]</span>
  <span class="token punctuation brackets-braces" >}</span>
<span class="token punctuation brackets-braces" >}</span>
</code></pre>
<p>See more usage examples and options <a href="https://github.com/sapegin/mrm#usage">in the docs</a>.</p>
<h2 class="header"><a class="header-anchor" href="#bots" id="bots"></a><span class="text">Bots</span><a class="header-anchor-select" href="#bots">#</a></h2>
<p>TODO</p>
<ul>
<li><a href="https://github.com/babel/babel-bot">https://github.com/babel/babel-bot</a></li>
<li><a href="https://github.com/open-bot/open-bot">https://github.com/open-bot/open-bot</a></li>
<li><a href="https://github.com/probot/probot">https://github.com/probot/probot</a></li>
<li>What problems bots solve</li>
</ul>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>TODO</p>
</div></div><div class="page__section"><div class="social-links"><h2 class="social-links__header">Subscribe to the blog updates</h2><blockquote class="tip social-links__tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" target="_blank" class="css-1nfeoes css-va8n550"><input type="email" class="css-baseStyle-s4lgck css-inputStyle-16d70pc" placeholder="Email" name="EMAIL" id="mce-EMAIL" required=""/><div style="display:none;position:absolute;left:-5000px"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><input type="submit" class="css-baseStyle-s4lgck css-buttonStyle-1y781j1" value="Subscribe" name="subscribe"/></form></div><div class="css-r9vozr css-7ic71f0"><div class="css-panel-1asgzqv css-panelPrev-h368eu"><div class="css-1njlj0m css-7ic71f1">Previous chapter</div><a class="css-link-h8hsyv css-linkPrev-966ksh" href="/maintenance/infrastructure/continuous-integration/">Continuous Integration</a></div><div class="css-panel-1asgzqv css-panelNext-1i6c957"><div class="css-1njlj0m css-7ic71f1">Next chapter</div><a class="css-link-h8hsyv css-linkNext-1a0mc68" href="/maintenance/documentation/">Documentation</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-react">available through Leanpub</a>. By purchasing the book you support the development of further content.</p></blockquote><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div></div></div></div><footer class="css-eo7znu css-iscbe10"><ul class="css-jtawwa css-iscbe13 css-6482o6 css-3yjlwf0"><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="/atom.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><div class="css-1gd1yml css-iscbe11"><h3 class="css-oi3rzz css-iscbe12">From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/webcampzg-2018/">Experiences on WebCamp Zagreb 2018</a></li><li><a class="blog-teaser" href="/blog/webexpo-2018/">Experiences on WebExpo 2018</a></li><li><a class="blog-teaser" href="/blog/refract-interview/">Refract - Manage Component Side Effects the Reactive Way - Interview with Thomas Roch.</a></li><li><a class="blog-teaser" href="/blog/dss-interview/">DSS - Deterministic Style Sheets - Interview with Giuseppe Gurgone</a></li><li><a class="blog-teaser" href="/blog/fall-2018-events/">SurviveJS - Fall Events</a></li><li><a class="blog-teaser" href="/blog/uppy-interview/">Uppy - Painless Uploads for JavaScript - Interview with Artur Paikin</a></li><li><a class="blog-teaser" href="/blog/graphql-finland-interview/">GraphQL Finland - Learn GraphQL Up North - Interview with Mikhail Novikov</a></li></ul></div><ul aria-label="Other Juho&#x27;s books" class="css-6482o6 css-3yjlwf0"><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/maintenance/introduction"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - Maintenance: Streamline JavaScript Workflow</h4><img alt="Maintenance book cover" src="/2900d9b74e46ac6cdf984148c1a0c631.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-maintenance">Buy at Leanpub</a></li><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/react/introduction"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - React: From apprentice to master</h4><img alt="React book cover" src="/2412b7150d25c1dc3c309666132bc26e.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></li><li class="css-jtawwa css-nbe2jc1 css-10ozgd1 css-17pd6qu0"><a href="/webpack/foreword"><h4 class="css-i1gwhw css-nbe2jc0">SurviveJS - Webpack: From apprentice to master</h4><img alt="Webpack book cover" src="/20cf3367cf445212a90411ccd2282229.svg" width="255" height="329" class="css-1d87hyi css-nbe2jc2"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></li></ul></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '4b3ffdbff33831aa87c5b1f39889f2af',
          indexName: 'survivejs_maintenance',
          inputSelector: '#search',
          debug: false
        });
      </script></div>

    
  </body>
</html>
