<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimal-ui" />
    <meta
      name="description"
      content="
npm packages can be managed in multiple ways. The most common way is to have one package per a sour…" />
    <meta
      name="keywords"
      content="" />
    <meta property="og:site_name" content="SurviveJS" />
    <meta property="og:title" content="Managing Packages Using a Monorepo" />
    <meta property="og:description" content="
npm packages can be managed in multiple ways. The most common way is to have one package per a sour…" />
    <meta name="twitter:title" content="Managing Packages Using a Monorepo" />
    <meta name="twitter:description" content="
npm packages can be managed in multiple ways. The most common way is to have one package per a sour…" />
    <meta name="twitter:site" content="@SurviveJS" />
    <title>Managing Packages Using a Monorepo</title>
    
    <link rel='icon' type='image/png' href='/favicon.png'></link>

    
      <link href="/site.b3d3963666121130a860.css" rel="stylesheet">
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"
    />
  </head>
  <body>
    <header class="nav__wrapper"><input type="checkbox" class="nav__toggle" id="nav__toggle"/><label class="nav__toggle-label" for="nav__toggle"></label><a title="Appendices" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/maintenance/appendices/"><i class="icon-left-open"></i></a><nav class="nav"><ul class="nav__items"><li class="nav__link"><a href="https://graphql-finland.fi/">GraphQL Finland</a></li><li class="nav__link"><a href="/">Home</a></li><li class="nav__link"><a href="/blog/">Read the blog</a></li><li class="nav__link nav__link_selected"><a href="/maintenance/">Maintenance book</a></li><li class="nav__link"><a href="/react/">React book</a></li><li class="nav__link"><a href="/webpack/">Webpack book</a></li><li class="nav__link"><a href="/training/">Hire me</a></li><li class="nav__link"><a href="https://twitter.com/survivejs">@survivejs</a></li></ul></nav><a title="Customizing ESLint" aria-hidden="true" class="css-17k05uf css-isbjic0" href="/maintenance/appendices/customizing-eslint/"><i class="icon-right-open"></i></a></header><div class="page"><div class="css-b5dhuc css-8rlsag0"><div style="background-image:url(/d4245a35f1390720abaa271ddda4b5f2.jpg)" class="css-1huzfyy css-8rlsag1"></div><h1 class="css-13wbkqf css-8rlsag2">Managing Packages Using a Monorepo</h1><small aria-hidden="true" class="css-18xzi2i css-8rlsag3"><a href="https://pixabay.com/en/brand-data-mono-music-1851576/">Pexels (Public Domain)</a></small></div><div class="page__container"><div class="css-xfgthk css-20xtq50"><label for="sidebar-toggle" class="css-7vv0nt css-20xtq52">Table of contents</label><input type="checkbox" id="sidebar-toggle" class="css-38lglc css-20xtq53"/><div class="css-nyzxad css-20xtq51"><div class="toc-nav__wrapper"><div class="toc-nav__section"><input id="search" class="toc-nav__search" placeholder="Search"/></div><div class="toc-nav__section"><h4 class="toc-nav--header">Table of Contents</h4><ul class="toc-nav"><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/preface/">Preface</a></li><li class="toc-intro"><a class="toc-nav__link intro" href="/maintenance/introduction/">Introduction</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/packaging/">Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/where-to-start/">Where to Start Packaging</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/anatomy/">Anatomy of a Package</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/publishing/">Publishing Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/building/">Building Packages</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/standalone-builds/">Standalone Builds</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/packaging/managing-dependencies/">Managing Dependencies</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/code-quality/">Code Quality</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/linting/">Linting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/code-formatting/">Code Formatting</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/typing/">Typing</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/code-quality/testing/">Testing</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/infrastructure/">Infrastructure</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/processes/">Processes</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/continuous-integration/">Continuous Integration</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/infrastructure/automation/">Automation</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/documentation/">Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/readme/">README</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/change-log/">Change Logs</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/site/">Site</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/api/">API Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/misc/">Other Types of Documentation</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/documentation/linting/">Linting and Formatting</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/future/">Future</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/longevity/">Longevity</a></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/future/marketing/">Marketing</a></li><li class="toc-part"><a class="toc-nav__link part" href="/maintenance/appendices/">Appendices</a></li><li class="toc-chapter"><span class="toc-nav__link toc-nav__link--current chapter">Managing Packages Using a Monorepo</span></li><li class="toc-chapter"><a class="toc-nav__link chapter" href="/maintenance/appendices/customizing-eslint/">Customizing ESLint</a></li></ul></div><div class="toc-nav__section"></div></div></div></div><div class="page__main"><div class="page__section"><div><blockquote class="latestpost tip"><a class="latestpost-link" href="/blog/proppy-interview/">Proppy - Functional props composition for components - Interview with Fahad Ibnay Heylaal</a></blockquote></div><div class="chapter-content"><p>npm packages can be managed in multiple ways. The most common way is to have one package per a source repository. The problems begin when you have to orchestrate changes across multiple related packages. The idea of <strong>monorepos</strong> was designed for this purpose.</p>
<h2 class="header"><a class="header-anchor" href="#monorepos-what-are-they" id="monorepos-what-are-they"></a><span class="text">Monorepos - What Are They</span><a class="header-anchor-select" href="#monorepos-what-are-they">#</a></h2>
<p>A monorepo allows you to maintain multiple related packages within a single repository. Bigger projects, such as Babel or Jest, use this method for organizing their work. They use <a href="https://lernajs.io/">Lerna</a>, a tool designed to help maintaining monorepos. Lerna can figure out what packages to update through changes and help with the versioning problem.</p>
<p>Lerna itself is quite opinionated and can be replaced with a package like <a href="https://www.npmjs.com/package/mondorepo">mondorepo</a>, <a href="https://www.npmjs.com/package/oao">oao</a>, or custom scripts as <a href="https://github.com/cyclejs/cyclejs">Cycle.js</a> has done.</p>
<p>Regardless of the technical solution, the idea is always similar. Your packages will exist with a predefined directory and you can maintain other directories at the same level for higher level documentation, examples, and a project site. You can also create package README files as a part of the site to avoid redundancy and to keep code quality high.</p>
<p>To give you an idea of a monorepo, consider the following structure from Reactabular, a project of mine:</p>
<pre><code class="lang-bash"><span class="token keyword keyword-." >.</span>
├── docs/
├── lib/
├── node_modules/
├── packages
│   ├── reactabular-dnd
│   ├── reactabular-resizable
│   ├── reactabular-sticky
│   ├── reactabular-table
│   └── reactabular-virtualized
├── CHANGELOG.md
├── CONTRIBUTING.md
├── CONTRIBUTORS.md
├── LICENSE.md
├── README.md
├── lerna.json
├── package.json
└── webpack.config.babel.js
</code></pre>
<p>In practice there are more files and you can find more packages within the organization. I decided to push the core packages within this monorepo while I maintain secondary functionality not related strictly to it outside. A mixed model like this is one option.</p>
<h2 class="header"><a class="header-anchor" href="#managing-separate-repositories" id="managing-separate-repositories"></a><span class="text">Managing Separate Repositories</span><a class="header-anchor-select" href="#managing-separate-repositories">#</a></h2>
<p>Webpack is a popular project bundler. Managing the project comes with its own challenges. The project does <strong>not</strong> use a monorepo model. Instead, it has opted for organization based approach. It has two main organizations: one for the core and one for packages that complement the core — <a href="https://github.com/webpack-contrib">webpack-contrib</a>.</p>
<p>Separating each package to a repository of its own makes them snowflakes in sense that each repository easily becomes different and it’s hard to keep them in sync if infrastructure evolves somehow. To solve the problem, <a href="https://www.npmjs.com/package/webpack-defaults">webpack-defaults</a> was developed.</p>
<p>The idea was to push project configuration (e.g. GitHub templates, linting, testing setup) to a single package that could be consumed across webpack-contrib repositories. When you install <em>webpack-defaults</em> to your project, it writes an npm script that pulls project defaults from the package and migrates the project as well it can to follow the standard.</p>
<p>Sometimes this can mean replacing entire file (i.e. Travis CI configuration) but there are times when patching the existing configuration is enough (i.e. <code>.gitignore</code>). This allows you to maintain control and it avoids customization per project following specific needs.</p>
<p>The biggest win of pushing shared configuration to a package like this is that it allows webpack to push project standards to a single place where they can be maintained. The changes can be consumed by running a single command at each project. This still requires inspection by programmers but it beats the alternative where it’s not possible to cascade changes across projects.</p>
<p><em>webpack-defaults</em> relies on <a href="https://www.npmjs.com/package/mrm-core">mrm-core</a> for handling project level migrations. It’s at its best in patching configuration file formats like JSON or YAML. The problems begin if you have to patch JavaScript configuration as then the needed transformations become arbitrary given code can be written in so many ways. This is where <a href="https://www.npmjs.com/package/js-codemod">codemods</a> can come in for limited scenarios.</p>
<h2 class="header"><a class="header-anchor" href="#conclusion" id="conclusion"></a><span class="text">Conclusion</span><a class="header-anchor-select" href="#conclusion">#</a></h2>
<p>Monorepos provide a refreshing alternative to managing each package per repository. They allow you to share the same configuration across separate packages and also coordinate related changes more easily. The approach comes with technical cost as performing this orchestration requires tooling.</p>
<p>Another option is to push the configuration problem to a package as was done in <em>webpack-defaults</em>. This way you can manage shared standards in a single place and share them across multiple projects.</p>
</div></div><div class="page__section"><div class="social-links"><h2 class="social-links__header">Subscribe to the blog updates</h2><blockquote class="tip social-links__tip">If you enjoyed this page, consider subscribing to the mailing list below or following <a href="https://twitter.com/survivejs">@survivejs</a> for occasional updates. There is also <a href="/atom.xml">RSS</a> available for old beards (no pun intended).</blockquote><form action="//jster.us7.list-manage.com/subscribe/post?u=ed40c0084a0c5ba31b3365d65&amp;id=b853b8e786" method="post" target="_blank" class="css-1nfeoes css-va8n550"><input type="email" class="css-baseStyle-1jrw962 css-inputStyle-16d70pc" placeholder="Email" name="EMAIL" id="mce-EMAIL" required=""/><div style="display:none;position:absolute;left:-5000px"><input type="text" name="b_ed40c0084a0c5ba31b3365d65_b853b8e786" tabindex="-1" value=""/></div><input type="submit" class="css-baseStyle-1jrw962 css-buttonStyle-1y781j1" value="Subscribe" name="subscribe"/></form></div><div class="css-r9vozr css-7ic71f0"><div class="css-panel-1asgzqv css-panelPrev-h368eu"><div class="css-1njlj0m css-7ic71f1">Previous chapter</div><a class="css-link-h8hsyv css-linkPrev-966ksh" href="/maintenance/appendices/">Appendices</a></div><div class="css-panel-1asgzqv css-panelNext-1i6c957"><div class="css-1njlj0m css-7ic71f1">Next chapter</div><a class="css-link-h8hsyv css-linkNext-1a0mc68" href="/maintenance/appendices/customizing-eslint/">Customizing ESLint</a></div></div><blockquote class="tip"><p>This book is <a href="https://leanpub.com/survivejs-react">available through Leanpub</a>. By purchasing the book you support the development of further content.</p></blockquote><div id="disqus_thread"></div><script type="text/javascript">var disqus_shortname = 'survivejs';(function() {var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script></div></div></div></div><footer class="css-eo7znu css-iscbe10"><ul class="css-jtawwa css-iscbe13 css-6482o6 css-3yjlwf0"><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://twitter.com/survivejs" target="_blank" rel="noopener noreferrer">@survivejs</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://eepurl.com/bth1v5" target="_blank" rel="noopener noreferrer">Mailing List</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://gitter.im/survivejs" target="_blank" rel="noopener noreferrer">Gitter Chat</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs" target="_blank" rel="noopener noreferrer">GitHub</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://presentations.survivejs.com" target="_blank" rel="noopener noreferrer">Presentations</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="http://goo.gl/forms/OWdGIOdHm9" target="_blank" rel="noopener noreferrer">Contact</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="https://github.com/survivejs/ama/issues" target="_blank" rel="noopener noreferrer">Ask Me Anything</a></li><li class="css-haw22i css-iscbe14 css-10ozgd1 css-17pd6qu0"><a href="/atom.xml" target="_blank" rel="noopener noreferrer">RSS</a></li></ul><div class="css-1gd1yml css-iscbe11"><h3 class="css-oi3rzz css-iscbe12">From the Blog</h3><ul class="blog-teasers"><li><a class="blog-teaser" href="/blog/proppy-interview/">Proppy - Functional props composition for components - Interview with Fahad Ibnay Heylaal</a></li><li><a class="blog-teaser" href="/blog/summer-2018-events/">SurviveJS - Summer Events</a></li><li><a class="blog-teaser" href="/blog/fastpack-interview/">Fastpack - Pack JavaScript code fast and easy - Interview with Oleksiy Golovko</a></li><li><a class="blog-teaser" href="/blog/lint-staged-interview/">lint-staged - Run Linters on git Staged Files - Interview with Andrey Okonetchnikov</a></li><li><a class="blog-teaser" href="/blog/webpack-book-updated-to-webpack-4/">&quot;SurviveJS - Webpack&quot; Updated to webpack 4</a></li><li><a class="blog-teaser" href="/blog/webpack-in-munich-may-2018/">Webpack in Munich, May 2018</a></li><li><a class="blog-teaser" href="/blog/concat-2018/">Experiences on Concat 2018</a></li></ul></div><ul class="css-6482o6 css-3yjlwf0"><li class="css-jtawwa css-3bvg0c0 css-10ozgd1 css-17pd6qu0"><a href="/maintenance/introduction"><img alt="Maintenance book cover" src="/44f3a3a3dad86956efa57dea740c5d44.png" width="255" height="329" class="css-1d87hyi css-3bvg0c1"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-maintenance">Buy at Leanpub</a></li><li class="css-jtawwa css-3bvg0c0 css-10ozgd1 css-17pd6qu0"><a href="/react/introduction"><img alt="React book cover" src="/b61671d95f81496495f2587a10ddb122.png" width="255" height="329" class="css-1d87hyi css-3bvg0c1"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-react">Buy at Leanpub</a></li><li class="css-jtawwa css-3bvg0c0 css-10ozgd1 css-17pd6qu0"><a href="/webpack/foreword"><img alt="Webpack book cover" src="/8f86c1d07d5536454690030cd1a10b53.png" width="255" height="329" class="css-1d87hyi css-3bvg0c1"/></a><a class="btn btn--normal css-button-v0k0bo" href="https://leanpub.com/survivejs-webpack">Buy at Leanpub</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/9526868803/">Buy at Amazon</a><a class="btn btn--normal css-button-v0k0bo" href="https://www.amazon.com/dp/B06XWZZGBS">Buy for Kindle</a></li></ul></footer><div><div class="gitter-open-chat-button">Need help?</div><script type="text/javascript">
          ((window.gitter = {}).chat = {}).options = {
            showChatByDefault: false,
            activationElement: '.gitter-open-chat-button',
            room: 'survivejs/react'
          };
        </script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async="" defer=""></script></div><div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js"></script><script type="text/javascript">
        docsearch({
          apiKey: '4b3ffdbff33831aa87c5b1f39889f2af',
          indexName: 'survivejs_maintenance',
          inputSelector: '#search',
          debug: false
        });
      </script></div>

    
  </body>
</html>
